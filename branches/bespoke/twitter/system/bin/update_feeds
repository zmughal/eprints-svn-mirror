#!/usr/bin/perl -w -I/opt/eprints3/perl_lib


use EPrints;

use strict;
use warnings;

my $eprints = EPrints->new;

# Load up the repositories
my $reps;
foreach my $id ( $eprints->repository_ids() )
{
	$reps->{$id} = $eprints->repository( $id ); 
	EPrints->abort( "Error loading $id" ) if !defined $reps->{$id};
}

if ($ARGV[0] and $ARGV[0] eq 'regenerate_mains')
{
	EPrints::Feed::Twitter::Update::generate_mains( $reps, 1 );
}
else
{
	EPrints::Feed::Twitter::Update::update_all( $reps );
}


