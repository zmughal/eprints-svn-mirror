######################################################################
#
#  EPrints Submission Forms
#
######################################################################
#
#  __COPYRIGHT__
#
# Copyright 2000-2008 University of Southampton. All Rights Reserved.
# 
#  __LICENSE__
#
######################################################################

use EPrints;

use strict;
my $session = new EPrints::Session;
exit( 0 ) unless( defined $session );

# Check we have privs
if( !$session->auth_check( "deposit" ) )
{
	$session->terminate();
	exit( 0 );
}

my $user = $session->current_user();

my $wfopt = $session->get_archive()->get_conf( "use_workflow" );

if( $wfopt )
{
	my $wfproc = new EPrints::Workflow::Processor(
		$session,
		'submit' );
	$wfproc->render( 'metadata' );
}
else
{
	my $subform = new EPrints::SubmissionForm(
		$session,
		$session->get_archive->get_conf( "userhome" ),
		0,
	       	$session->get_archive->get_dataset( "inbox" ),
		"submit" );
	$subform->process;
}

$session->terminate;
