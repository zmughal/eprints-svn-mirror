#!/usr/bin/perl -w -I/usr/share/eprints3/perl_lib

use strict;

use EPrints;

if(!defined $ARGV[0] || !defined $ARGV[1])
{
       print "\nUsage is:";
       print "\n\tinstall_app repository_id [install|uninstall] [app_name|app_path] [--force]\n\n";
       exit(1);
}

my $repository = new EPrints::Session( 1, $ARGV[0] ) or die("cant create Session object");

my $operation = $ARGV[1];

my $local_file_path = $ARGV[2];

my $force = 0;

if (defined $ARGV[3]) {
	if ( "$ARGV[3]" eq "--force" ) {

		$force = 1;

	}
}
my $rc = 0;
my $message = "";
my $package_name = "";
if ( $operation eq "install") {
	
	($rc, $message) = EPrints::EPM::install($repository,$local_file_path,$force);

} elsif ($operation eq "remove" ) {
	
	($rc, $message) = EPrints::EPM::remove($repository,$local_file_path,$force);

} elsif ($operation eq "backup" ) {
	
	$message = EPrints::EPM::make_backup($repository, $local_file_path);

} elsif ($operation eq "get_version") {
	
	$message = EPrints::EPM::get_package_version($repository, $local_file_path);

} elsif ($operation eq "check_md5") {
	
	$message = EPrints::EPM::check_required_md5($repository, $local_file_path, "/tmp/A0j3aI2qDT", "/home/dct05r/eprints/archives/upping/cfg/plugins/EPrints/Plugin/Screen/Admin/TestScreen.pm");

} elsif ($operation eq "check_install") {

	
	$message = EPrints::EPM::check_install($repository);

}


print $message . "\n";

1;
