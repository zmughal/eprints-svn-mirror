#!/usr/bin/perl -w -I/opt/eprints/perl_lib

######################################################################
#
#  Process monthly subscriptions.
#
#   This script should be run once a month. Running it twice in one month
#   will result in the monthly subscriptions being sent out twice.
#
######################################################################
#
#  __COPYRIGHT__
#
# Copyright 2000-2008 University of Southampton. All Rights Reserved.
# 
#  __LICENSE__
#
######################################################################


use EPrints::Database;
use EPrints::Session;
use EPrints::Subscription;
use EPrints::User;

use strict;

# Set STDOUT to auto flush (without needing a \n)
$|=1;


# Create offline session
my $session = new EPrints::Session( 1 );
exit( 1 ) unless( defined $session );

my @subs = EPrints::Subscription::get_monthly( $session );

foreach $sub (@subs)
{
	$sub->process();
}
