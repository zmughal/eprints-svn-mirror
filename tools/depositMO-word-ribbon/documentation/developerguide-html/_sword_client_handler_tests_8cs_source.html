<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Word 2010 DepositMO plugin - API reference and source guide: Q:/Projects/SwordHandler/SwordHandler/SwordClientHandlerTests.cs Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>Q:/Projects/SwordHandler/SwordHandler/SwordClientHandlerTests.cs</h1>  </div>
</div>
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 ï»¿<span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment">   Copyright 2011 University of Southampton</span>
<a name="l00003"></a>00003 <span class="comment"></span>
<a name="l00004"></a>00004 <span class="comment">   Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<a name="l00005"></a>00005 <span class="comment">   you may not use this file except in compliance with the License.</span>
<a name="l00006"></a>00006 <span class="comment">   You may obtain a copy of the License at</span>
<a name="l00007"></a>00007 <span class="comment"></span>
<a name="l00008"></a>00008 <span class="comment">       http://www.apache.org/licenses/LICENSE-2.0</span>
<a name="l00009"></a>00009 <span class="comment"></span>
<a name="l00010"></a>00010 <span class="comment">   Unless required by applicable law or agreed to in writing, software</span>
<a name="l00011"></a>00011 <span class="comment">   distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<a name="l00012"></a>00012 <span class="comment">   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<a name="l00013"></a>00013 <span class="comment">   See the License for the specific language governing permissions and</span>
<a name="l00014"></a>00014 <span class="comment">   limitations under the License.</span>
<a name="l00015"></a>00015 <span class="comment">*/</span>
<a name="l00016"></a>00016 
<a name="l00017"></a>00017 <span class="keyword">using</span> System;
<a name="l00018"></a>00018 <span class="keyword">using</span> System.Collections.Generic;
<a name="l00019"></a>00019 <span class="keyword">using</span> System.Linq;
<a name="l00020"></a>00020 <span class="keyword">using</span> System.Text;
<a name="l00021"></a>00021 <span class="keyword">using</span> System.Xml;
<a name="l00022"></a>00022 <span class="keyword">using</span> System.Diagnostics;
<a name="l00023"></a>00023 <span class="keyword">using</span> System.Threading;
<a name="l00024"></a>00024 
<a name="l00025"></a>00025 <span class="keyword">namespace </span>uk.ac.soton.ses
<a name="l00026"></a>00026 {
<a name="l00030"></a><a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler_tests.html">00030</a>     <span class="keyword">internal</span> <span class="keyword">class </span><a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler_tests.html" title="A series of basic tests for the .NET API.">SwordClientHandlerTests</a>
<a name="l00031"></a>00031     {
<a name="l00032"></a><a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler_tests.html#a797298d93937219523c03e61d4dc7fdb">00032</a>         <span class="keywordtype">string</span> sword2User = null;
<a name="l00033"></a><a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler_tests.html#af7f941f17aae44575bef1d9f62c3cee1">00033</a>         <span class="keywordtype">string</span> sword2Password = null;
<a name="l00034"></a><a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler_tests.html#a6f471207a927cf9e3ead0a4429b91961">00034</a>         <span class="keywordtype">string</span> sword2Endpoint = null;
<a name="l00035"></a>00035 
<a name="l00036"></a><a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler_tests.html#a91fcddabfb75bd25e521d1ed5c5d899b">00036</a>         <span class="keyword">internal</span> <span class="keywordtype">string</span> EPRINT_TO_DELETE = <span class="stringliteral">&quot;http://depositmo.eprints.org/id/eprint/58&quot;</span>;
<a name="l00037"></a>00037 
<a name="l00038"></a><a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler_tests.html#abadb7f035084adcc5d06d3ad21b8979e">00038</a>         XmlWriterSettings xws = <span class="keyword">new</span> XmlWriterSettings();
<a name="l00039"></a><a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler_tests.html#a507eaed9dded7a20c8c866a081e15240">00039</a>         XmlWriter consoleWriter = null;
<a name="l00040"></a><a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler_tests.html#af5a5339042b05de2f9c08343eb4d4e9d">00040</a>         XmlDocument response = null;
<a name="l00041"></a>00041 
<a name="l00042"></a><a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler_tests.html#ad40b7cb5a32a80f09aae92d27057eaf7">00042</a>         <span class="keyword">public</span> <a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler_tests.html" title="A series of basic tests for the .NET API.">SwordClientHandlerTests</a>(<span class="keywordtype">string</span> sword2User, <span class="keywordtype">string</span> sword2Password, <span class="keywordtype">string</span> sword2Endpoint)
<a name="l00043"></a>00043         {
<a name="l00044"></a>00044             this.sword2User = sword2User;
<a name="l00045"></a>00045             this.sword2Password = sword2Password;
<a name="l00046"></a>00046             this.sword2Endpoint = sword2Endpoint;
<a name="l00047"></a>00047             this.xws.Indent = <span class="keyword">true</span>;
<a name="l00048"></a>00048             this.consoleWriter = XmlWriter.Create(Console.Out, <span class="keyword">this</span>.xws);
<a name="l00049"></a>00049         }
<a name="l00050"></a>00050 
<a name="l00051"></a><a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler_tests.html#adcc45e92c92f1cd6c57ff758ad3bf1c3">00051</a>         <span class="keyword">public</span> <span class="keywordtype">void</span> Run()
<a name="l00052"></a>00052         {
<a name="l00053"></a>00053             <span class="keywordtype">bool</span> runAllTests = <span class="keyword">false</span>;
<a name="l00054"></a>00054             <span class="keywordtype">bool</span> testPutToDocument = <span class="keyword">true</span>;
<a name="l00055"></a>00055             <span class="keywordtype">bool</span> testDepositZipToEprint = <span class="keyword">false</span>;
<a name="l00056"></a>00056             <span class="keywordtype">bool</span> testDepositEprintsXml = <span class="keyword">false</span>;
<a name="l00057"></a>00057             <span class="keywordtype">bool</span> testAtomReader = <span class="keyword">false</span>;
<a name="l00058"></a>00058             <span class="keywordtype">bool</span> testDelete = <span class="keyword">false</span>;
<a name="l00059"></a>00059             <span class="keywordtype">bool</span> testList = <span class="keyword">false</span>;
<a name="l00060"></a>00060             <span class="keywordtype">bool</span> testResolveInbox = <span class="keyword">false</span>;
<a name="l00061"></a>00061             <span class="keywordtype">bool</span> testGetInfo = <span class="keyword">false</span>;
<a name="l00062"></a>00062             <span class="keywordtype">bool</span> testCreateContainer = <span class="keyword">false</span>;
<a name="l00063"></a>00063             <span class="keywordtype">bool</span> testPutOnly = <span class="keyword">false</span>;
<a name="l00064"></a>00064 
<a name="l00065"></a>00065             <a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html" title="SWORD 2 client implementation for .NET.">SwordClientHandler</a> sword2Handler = <span class="keyword">new</span> <a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html" title="SWORD 2 client implementation for .NET.">SwordClientHandler</a>(this.sword2User, this.sword2Password, this.sword2Endpoint);
<a name="l00066"></a>00066 
<a name="l00067"></a>00067             <span class="keywordflow">if</span> (testResolveInbox || runAllTests)
<a name="l00068"></a>00068             {
<a name="l00069"></a>00069                 this.TestResolveInbox(sword2Handler);
<a name="l00070"></a>00070             }
<a name="l00071"></a>00071 
<a name="l00072"></a>00072             <span class="keywordflow">if</span> (testAtomReader || runAllTests)
<a name="l00073"></a>00073             {
<a name="l00074"></a>00074                 this.TestAtomReader();
<a name="l00075"></a>00075             }
<a name="l00076"></a>00076 
<a name="l00077"></a>00077             <span class="keywordflow">if</span> (testDelete || runAllTests)
<a name="l00078"></a>00078             {
<a name="l00079"></a>00079                 this.TestDelete(sword2Handler, EPRINT_TO_DELETE);
<a name="l00080"></a>00080             }
<a name="l00081"></a>00081 
<a name="l00082"></a>00082             <span class="keywordflow">if</span> (testDepositZipToEprint || runAllTests)
<a name="l00083"></a>00083             {
<a name="l00084"></a>00084                 this.TestDepositZipToEprint(sword2Handler);
<a name="l00085"></a>00085             }
<a name="l00086"></a>00086             
<a name="l00087"></a>00087             <span class="keywordflow">if</span> (testPutToDocument || runAllTests)
<a name="l00088"></a>00088             {
<a name="l00089"></a>00089                 TestPutToDocument(sword2Handler);
<a name="l00090"></a>00090             }
<a name="l00091"></a>00091 
<a name="l00092"></a>00092             <span class="keywordflow">if</span> (testDepositEprintsXml || runAllTests)
<a name="l00093"></a>00093             {
<a name="l00094"></a>00094                 this.TestDepositEprintsXml(sword2Handler);
<a name="l00095"></a>00095             }
<a name="l00096"></a>00096 
<a name="l00097"></a>00097             <span class="keywordflow">if</span> (testList || runAllTests)
<a name="l00098"></a>00098             {
<a name="l00099"></a>00099                 this.TestList(sword2Handler);
<a name="l00100"></a>00100             }
<a name="l00101"></a>00101 
<a name="l00102"></a>00102             <span class="keywordflow">if</span> (testGetInfo || runAllTests)
<a name="l00103"></a>00103             {
<a name="l00104"></a>00104                 this.TestGetInfo(sword2Handler);            
<a name="l00105"></a>00105             }
<a name="l00106"></a>00106 
<a name="l00107"></a>00107             <span class="keywordflow">if</span> (testCreateContainer || runAllTests)
<a name="l00108"></a>00108             {
<a name="l00109"></a>00109                 this.TestCreateContainer(sword2Handler);
<a name="l00110"></a>00110             }
<a name="l00111"></a>00111 
<a name="l00112"></a>00112             <span class="keywordflow">if</span> (testPutOnly)
<a name="l00113"></a>00113             {
<a name="l00114"></a>00114                 this.TestPutOnly(sword2Handler);
<a name="l00115"></a>00115             }
<a name="l00116"></a>00116 
<a name="l00117"></a>00117             <span class="keywordflow">if</span> (this.response != null)
<a name="l00118"></a>00118             {
<a name="l00119"></a>00119                 response.WriteTo(consoleWriter);
<a name="l00120"></a>00120                 consoleWriter.Flush();
<a name="l00121"></a>00121             }
<a name="l00122"></a>00122         }
<a name="l00123"></a>00123 
<a name="l00124"></a><a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler_tests.html#a990e41f994e3e36515182ae3474843c5">00124</a>         <span class="keyword">private</span> <span class="keywordtype">void</span> TestDelete(<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html" title="SWORD 2 client implementation for .NET.">SwordClientHandler</a> sword2Handler, <span class="keywordtype">string</span> targetToDelete)
<a name="l00125"></a>00125         {
<a name="l00126"></a>00126             Debug.WriteLine(String.Format(<span class="stringliteral">&quot;Deleting document at {0}&quot;</span>, targetToDelete));
<a name="l00127"></a>00127             XmlDocument atomResponse = sword2Handler.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a0cfde100b3ab78e06e0fa6c51d1f97e2" title="Deletes the document at the target address swordUrl.">Delete</a>(targetToDelete);
<a name="l00128"></a>00128             Debug.WriteLine(<span class="stringliteral">&quot;Finished deletion test&quot;</span>);
<a name="l00129"></a>00129         }
<a name="l00130"></a>00130 
<a name="l00131"></a><a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler_tests.html#ae8fa9b4a361199bb47685bf6b6d5f108">00131</a>         <span class="keyword">private</span> <span class="keywordtype">void</span> TestPutOnly(<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html" title="SWORD 2 client implementation for .NET.">SwordClientHandler</a> sword2Handler)
<a name="l00132"></a>00132         {
<a name="l00133"></a>00133             <span class="keywordtype">bool</span> result = sword2Handler.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#af7267ae1dcd8e060bc81f88f4d1d39b3" title="Performs a PUT to the supplied endpoint with the supplied document filename using DOCX_CONTENTTYPE...">PutToDocument</a>(<span class="stringliteral">@&quot;P:\tmp\hyb.docx&quot;</span>, <span class="stringliteral">&quot;http://depositmo.eprints.org/id/document/1736664&quot;</span>);<span class="comment">//&quot;http://depositmo.eprints.org/id/document/1736641&quot;);</span>
<a name="l00134"></a>00134             <span class="keywordflow">return</span>;
<a name="l00135"></a>00135         }
<a name="l00136"></a>00136 
<a name="l00137"></a><a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler_tests.html#aedba9f8d438d1a4f4646ef49bb7e793d">00137</a>         <span class="keyword">private</span> <span class="keywordtype">void</span> TestPutToDocument(<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html" title="SWORD 2 client implementation for .NET.">SwordClientHandler</a> sword2Handler)
<a name="l00138"></a>00138         {
<a name="l00139"></a>00139             Debug.WriteLine(<span class="stringliteral">&quot;Depositing new .docx&quot;</span>);
<a name="l00140"></a>00140             <span class="comment">//XmlDocument atomResponse = sword2Handler.DepositDocxToEprint(@&quot;P:\tmp\hy.docx&quot;);</span>
<a name="l00141"></a>00141             <span class="keywordtype">string</span> locationHeader = sword2Handler.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a983f0345d3573e656bbd53bd385cec79" title="Creates a container on the repository and posts the supplied docx file to that container.">PostDocxToRepository</a>(<span class="stringliteral">@&quot;P:\tmp\hy.docx&quot;</span>);
<a name="l00142"></a>00142          
<a name="l00143"></a>00143             Debug.WriteLine(<span class="stringliteral">&quot;Initialising Atom response reader&quot;</span>);
<a name="l00144"></a>00144            <span class="comment">/*</span>
<a name="l00145"></a>00145 <span class="comment">            SwordAtomReader sar = new SwordAtomReader(atomResponse);</span>
<a name="l00146"></a>00146 <span class="comment">            </span>
<a name="l00147"></a>00147 <span class="comment">            Debug.WriteLine(&quot;Title was &quot; + sar.AtomTitle);</span>
<a name="l00148"></a>00148 <span class="comment">            Debug.WriteLine(&quot;Edit media href is &quot; + sar.EditMediaHref);</span>
<a name="l00149"></a>00149 <span class="comment">            Debug.WriteLine(&quot;Contents href is &quot; + sar.ContentsHref);*/</span>
<a name="l00150"></a>00150             <span class="comment">/*</span>
<a name="l00151"></a>00151 <span class="comment">            XmlDocument dereference = sword2Handler.GetAtomXml(sar.EditMediaHref);</span>
<a name="l00152"></a>00152 <span class="comment">            XmlDocument subdocument = new XmlDocument();</span>
<a name="l00153"></a>00153 <span class="comment">            XmlNamespaceManager xmlns = new XmlNamespaceManager(dereference.NameTable);</span>
<a name="l00154"></a>00154 <span class="comment">            //xmlns.AddNamespace(&quot;default&quot;, &quot;&quot;);</span>
<a name="l00155"></a>00155 <span class="comment">            //xmlns.AddNamespace(&quot;atom&quot;, &quot;http://www.w3.org/2005/Atom&quot;);</span>
<a name="l00156"></a>00156 <span class="comment">            xmlns.AddNamespace(String.Empty, &quot;http://www.w3.org/2005/Atom&quot;);</span>
<a name="l00157"></a>00157 <span class="comment">            subdocument.AppendChild(dereference.SelectSingleNode(&quot;//feed&quot;, xmlns));</span>
<a name="l00158"></a>00158 <span class="comment">            SwordAtomReader sar2 = new SwordAtomReader(subdocument);</span>
<a name="l00159"></a>00159 <span class="comment">            */</span>
<a name="l00160"></a>00160             
<a name="l00161"></a>00161 
<a name="l00162"></a>00162             Debug.WriteLine(<span class="stringliteral">&quot;Attempting to update document after a few seconds ...&quot;</span>);
<a name="l00163"></a>00163             Thread.Sleep(30 * 1000);
<a name="l00164"></a>00164             <span class="comment">//bool result = sword2Handler.PutToDocument(@&quot;P:\tmp\hyb.docx&quot;, sar.EditMediaHref);</span>
<a name="l00165"></a>00165             <span class="keywordtype">bool</span> result = sword2Handler.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#af7267ae1dcd8e060bc81f88f4d1d39b3" title="Performs a PUT to the supplied endpoint with the supplied document filename using DOCX_CONTENTTYPE...">PutToDocument</a>(<span class="stringliteral">@&quot;P:\tmp\hyb.docx&quot;</span>, locationHeader); <span class="comment">//sar.ContentsHref);</span>
<a name="l00166"></a>00166             
<a name="l00167"></a>00167             <span class="comment">// note that until at least 15th December 2010, this response is not Atom XML so</span>
<a name="l00168"></a>00168             <span class="comment">// the following is/was not valid. However, the update to the title was occurring</span>
<a name="l00169"></a>00169             
<a name="l00170"></a>00170             Debug.WriteLine(<span class="stringliteral">&quot;Update result: &quot;</span> + result.ToString());
<a name="l00171"></a>00171         }
<a name="l00172"></a>00172 
<a name="l00173"></a><a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler_tests.html#ae6da507cf2e79983df20b4e0906b5f92">00173</a>         <span class="keyword">private</span> <span class="keywordtype">void</span> TestResolveInbox(<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html" title="SWORD 2 client implementation for .NET.">SwordClientHandler</a> sword2Handler)
<a name="l00174"></a>00174         {
<a name="l00175"></a>00175             <span class="keywordtype">bool</span> origvalue = sword2Handler.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a9e50e2fb359bcae16dbd2e39dccfe493" title="TODO: Whether the inbox URL should be resolved from the HTML of the supplied endpoint.">_resolveInbox</a>;
<a name="l00176"></a>00176             sword2Handler.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a9e50e2fb359bcae16dbd2e39dccfe493" title="TODO: Whether the inbox URL should be resolved from the HTML of the supplied endpoint.">_resolveInbox</a> = <span class="keyword">true</span>;
<a name="l00177"></a>00177             sword2Handler.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#af74880abd60b9ca07bdbeb69207a6052" title="Resolves the inbox based on the currently-supplied endpoint.">ResolveInbox</a>();
<a name="l00178"></a>00178             <span class="comment">// leave things as we found them</span>
<a name="l00179"></a>00179             sword2Handler.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a9e50e2fb359bcae16dbd2e39dccfe493" title="TODO: Whether the inbox URL should be resolved from the HTML of the supplied endpoint.">_resolveInbox</a> = origvalue;
<a name="l00180"></a>00180         }
<a name="l00181"></a>00181 
<a name="l00182"></a><a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler_tests.html#a58c5c433e7ca4c50a5a5254103947b4a">00182</a>         <span class="keyword">private</span> <span class="keywordtype">void</span> TestDepositZipToEprint(<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html" title="SWORD 2 client implementation for .NET.">SwordClientHandler</a> sword2Handler)
<a name="l00183"></a>00183         {
<a name="l00184"></a>00184             Debug.WriteLine(<span class="stringliteral">&quot;Depositing zip file&quot;</span>);
<a name="l00185"></a>00185             this.response = sword2Handler.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a6f64cc11c5c3bb44fa6669c6c53f007c" title="Deposits the zip file in the supplied filename to the initialised endpoint with a gzip content type (...">DepositZipToEprint</a>(<span class="stringliteral">@&quot;P:\tmp\depositmo_sword2_test_scripts\pics.tar.gz&quot;</span>);
<a name="l00186"></a>00186             <a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_atom_reader.html" title="SWORD 2 Atom XML reader.">SwordAtomReader</a> sar = <span class="keyword">new</span> <a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_atom_reader.html" title="SWORD 2 Atom XML reader.">SwordAtomReader</a>(this.response);
<a name="l00187"></a>00187             Debug.WriteLine(<span class="stringliteral">&quot;ID was &quot;</span> + sar.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_atom_reader.html#a29dd5db71fe62568fc957a6aa012bf24" title="Atom ID.">AtomId</a>);
<a name="l00188"></a>00188         }        
<a name="l00189"></a>00189 
<a name="l00190"></a><a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler_tests.html#aa5f4c27a39cb644ebcc807e10fae5b15">00190</a>         <span class="keyword">private</span> <span class="keywordtype">void</span> TestDepositEprintsXml(<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html" title="SWORD 2 client implementation for .NET.">SwordClientHandler</a> sword2Handler)
<a name="l00191"></a>00191         {
<a name="l00192"></a>00192             Debug.WriteLine(<span class="stringliteral">&quot;Depositing XML file&quot;</span>);
<a name="l00193"></a>00193             XmlDocument xmlDocument = <span class="keyword">new</span> XmlDocument();
<a name="l00194"></a>00194             xmlDocument.Load(<span class="stringliteral">@&quot;P:\tmp\depositmo_sword2_test_scripts\test-import.xml&quot;</span>);
<a name="l00195"></a>00195             this.response = sword2Handler.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a202cd2ddb02ca36902c8b5b2160f5ae7" title="Deposits the EP2 XML document to the initialised endpoint with X-Packaging type EP2_PACKAGING">DepositEprintsXml</a>(xmlDocument);
<a name="l00196"></a>00196             <a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_atom_reader.html" title="SWORD 2 Atom XML reader.">SwordAtomReader</a> sar = <span class="keyword">new</span> <a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_atom_reader.html" title="SWORD 2 Atom XML reader.">SwordAtomReader</a>(this.response);
<a name="l00197"></a>00197             Debug.WriteLine(<span class="stringliteral">&quot;ID was &quot;</span> + sar.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_atom_reader.html#a29dd5db71fe62568fc957a6aa012bf24" title="Atom ID.">AtomId</a>);
<a name="l00198"></a>00198         }
<a name="l00199"></a>00199 
<a name="l00200"></a><a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler_tests.html#a902366c6c46c808096873e3d5455e3ee">00200</a>         <span class="keyword">private</span> <span class="keywordtype">void</span> TestGetInfo(<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html" title="SWORD 2 client implementation for .NET.">SwordClientHandler</a> sword2Handler)
<a name="l00201"></a>00201         {
<a name="l00202"></a>00202             this.response = sword2Handler.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#ae858efe4c9e1bf559f8f6003b581686b" title="Gets information about the ePrint at the provided URI.">GetEprintInfo</a>(<span class="stringliteral">&quot;http://bazaar.eprints.org/id/eprint/23&quot;</span>);
<a name="l00203"></a>00203             <a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_atom_reader.html" title="SWORD 2 Atom XML reader.">SwordAtomReader</a> sar = <span class="keyword">new</span> <a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_atom_reader.html" title="SWORD 2 Atom XML reader.">SwordAtomReader</a>(this.response);
<a name="l00204"></a>00204             Console.WriteLine(<span class="stringliteral">&quot;Atom title is {0}&quot;</span>, sar.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_atom_reader.html#a342b7034d062be53e6345c6a8b0a08d6" title="Atom title.">AtomTitle</a>);
<a name="l00205"></a>00205             Console.WriteLine(<span class="stringliteral">&quot;Contents href is {0}&quot;</span>, sar.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_atom_reader.html#aa909e1f6fd2bd56f7845f7b10cef1f82" title="Contents href.">ContentsHref</a>);
<a name="l00206"></a>00206 
<a name="l00207"></a>00207             Debug.WriteLine(<span class="stringliteral">&quot;Got info!&quot;</span>);
<a name="l00208"></a>00208         }
<a name="l00209"></a>00209 
<a name="l00210"></a><a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler_tests.html#a835a76fa7e3aaaa8eed717238b6d03f7">00210</a>         <span class="keyword">private</span> <span class="keywordtype">void</span> TestList(<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html" title="SWORD 2 client implementation for .NET.">SwordClientHandler</a> sword2Handler)
<a name="l00211"></a>00211         {
<a name="l00212"></a>00212             Debug.WriteLine(<span class="stringliteral">&quot;Retrieving listing&quot;</span>);
<a name="l00213"></a>00213             <span class="comment">//XmlDocument xmlDocument = new XmlDocument();</span>
<a name="l00214"></a>00214             <span class="comment">//this.response = sword2Handler.ListRecords();</span>
<a name="l00215"></a>00215             <span class="comment">//Uri uri = new Uri(&quot;http://yomiko.ecs.soton.ac.uk:8027/more/parts/to/this/&quot;);</span>
<a name="l00216"></a>00216             <span class="comment">//string leftPart = uri.GetLeftPart(UriPartial.Authority);</span>
<a name="l00217"></a>00217 
<a name="l00218"></a>00218             <span class="comment">//XmlReader xr = XmlTextReader.Create(@&quot;C:\listresults.xml&quot;);</span>
<a name="l00219"></a>00219             <span class="comment">//this.response = new XmlDocument();</span>
<a name="l00220"></a>00220             <span class="comment">//this.response.Load(@&quot;C:\listresults.xml&quot;);</span>
<a name="l00221"></a>00221             <span class="comment">//SwordListReader slr2 = new SwordListReader(this.response);</span>
<a name="l00222"></a>00222 
<a name="l00223"></a>00223             <span class="comment">//return;</span>
<a name="l00224"></a>00224 
<a name="l00225"></a>00225             this.response = sword2Handler.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a18701ccda5403431fa3ead1d8ce05017" title="List all records at the endpoint.">ListRecords</a>(<span class="keyword">true</span>);
<a name="l00226"></a>00226             <span class="comment">//this.response.WriteTo(this.consoleWriter);</span>
<a name="l00227"></a>00227 
<a name="l00228"></a>00228             <a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_list_reader.html" title="SWORD list reader.">SwordListReader</a> slr = <span class="keyword">new</span> <a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_list_reader.html" title="SWORD list reader.">SwordListReader</a>(this.response);
<a name="l00229"></a>00229             
<a name="l00230"></a>00230             <span class="comment">//XmlWriter xw=XmlTextWriter.Create(@&quot;C:\listresults.xml&quot;);</span>
<a name="l00231"></a>00231             <span class="comment">//this.response.WriteTo(xw);</span>
<a name="l00232"></a>00232             <span class="comment">//xw.Close();</span>
<a name="l00233"></a>00233 
<a name="l00234"></a>00234             <span class="keywordflow">foreach</span> (<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_list_entry.html" title="SWORD entry for the collection list.">SwordListEntry</a> sle <span class="keywordflow">in</span> slr.Entries)
<a name="l00235"></a>00235             {
<a name="l00236"></a>00236                 Console.WriteLine(<span class="stringliteral">&quot;Title: &quot;</span> + sle.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_list_entry.html#a93ca27886989680414fb6f7975c3cd19" title="Title of the entry.">Title</a>);
<a name="l00237"></a>00237             }
<a name="l00238"></a>00238 
<a name="l00239"></a>00239             this.consoleWriter.Flush();
<a name="l00240"></a>00240             Console.Out.Flush();
<a name="l00241"></a>00241             Console.ReadKey();
<a name="l00242"></a>00242         }
<a name="l00243"></a>00243 
<a name="l00244"></a><a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler_tests.html#a0207e3b9a87ead51a8f1c1195362bf55">00244</a>         <span class="keyword">private</span> <span class="keywordtype">void</span> TestAtomReader()
<a name="l00245"></a>00245         {
<a name="l00246"></a>00246             XmlDocument atomResponse = <span class="keyword">new</span> XmlDocument();
<a name="l00247"></a>00247             <span class="comment">//atomResponse.LoadXml(@&quot;&lt;?xml version=&quot;&quot;1.0&quot;&quot; encoding=&quot;&quot;UTF-8&quot;&quot;?&gt;&lt;atom:entry xmlns:atom=&quot;&quot;http://www.w3.org/2005/Atom&quot;&quot; xmlns:sword=&quot;&quot;http://purl.org/net/sword/&quot;&quot;&gt;  &lt;atom:title&gt;On Testing the Atom Protocol...&lt;/atom:title&gt;  &lt;atom:id&gt;http://depositmo.eprints.org/id/eprint/40&lt;/atom:id&gt;  &lt;atom:updated&gt;2010-11-04T05:35:21Z&lt;/atom:updated&gt;  &lt;atom:published&gt;2006-10-25T00:45:02Z&lt;/atom:published&gt;  &lt;atom:author&gt;    &lt;atom:name&gt;admin&lt;/atom:name&gt;    &lt;atom:email&gt;davetaz@ecs.soton.ac.uk&lt;/atom:email&gt;  &lt;/atom:author&gt;  &lt;atom:summary type=&quot;&quot;text&quot;&quot; /&gt;  &lt;atom:content type=&quot;&quot;text/xml&quot;&quot; src=&quot;&quot;http://depositmo.eprints.org/id/document/206&quot;&quot; /&gt;  &lt;atom:link rel=&quot;&quot;edit-media&quot;&quot; href=&quot;&quot;http://depositmo.eprints.org/id/document/206&quot;&quot; /&gt;  &lt;atom:link rel=&quot;&quot;edit&quot;&quot; href=&quot;&quot;http://depositmo.eprints.org/sword-app/atom/40.atom&quot;&quot; /&gt;  &lt;atom:generator uri=&quot;&quot;http://depositmo.eprints.org&quot;&quot; version=&quot;&quot;1.3&quot;&quot;&gt;DepositMO / SWORD 2 Endpoint [eprints-build-2010-11-26-r5991]&lt;/atom:generator&gt;  &lt;sword:treatment&gt;Deposited items will remain in your user inbox until you manually send them for reviewing.&lt;/sword:treatment&gt;  &lt;sword:packaging&gt;http://eprints.org/ep2/data/2.0&lt;/sword:packaging&gt;  &lt;sword:noOp&gt;false&lt;/sword:noOp&gt;&lt;/atom:entry&gt;&quot;);</span>
<a name="l00248"></a>00248             atomResponse.LoadXml(<span class="stringliteral">@&quot;&lt;entry&gt;</span>
<a name="l00249"></a>00249 <span class="stringliteral">  &lt;title&gt;A magical and modified document&lt;/title&gt;</span>
<a name="l00250"></a>00250 <span class="stringliteral">  &lt;link rel=&quot;&quot;self&quot;&quot; href=&quot;&quot;http://depositmo.eprints.org/cgi/export/eprint/311/Atom/depositmo-eprint-311.xml&quot;&quot;/&gt;</span>
<a name="l00251"></a>00251 <span class="stringliteral">  &lt;link rel=&quot;&quot;edit&quot;&quot; href=&quot;&quot;http://depositmo.eprints.org/id/eprint/311&quot;&quot;/&gt;</span>
<a name="l00252"></a>00252 <span class="stringliteral">  &lt;link rel=&quot;&quot;edit-media&quot;&quot; href=&quot;&quot;http://depositmo.eprints.org/id/eprint/311/contents&quot;&quot;/&gt;</span>
<a name="l00253"></a>00253 <span class="stringliteral">  &lt;link rel=&quot;&quot;alternate&quot;&quot; href=&quot;&quot;http://depositmo.eprints.org/id/eprint/311&quot;&quot;/&gt;</span>
<a name="l00254"></a>00254 <span class="stringliteral">  &lt;summary&gt;Q., Hercules (2011) A magical and modified document.&lt;/summary&gt;</span>
<a name="l00255"></a>00255 <span class="stringliteral">  &lt;updated&gt;2011-03-03T08:01:37Z&lt;/updated&gt;</span>
<a name="l00256"></a>00256 <span class="stringliteral">  &lt;id&gt;http://depositmo.eprints.org/id/eprint/311&lt;/id&gt;</span>
<a name="l00257"></a>00257 <span class="stringliteral">  &lt;category term=&quot;&quot;article&quot;&quot; scheme=&quot;&quot;http://depositmo.eprints.org/data/eprint#type&quot;&quot;/&gt;</span>
<a name="l00258"></a>00258 <span class="stringliteral">  &lt;author&gt;</span>
<a name="l00259"></a>00259 <span class="stringliteral">    &lt;name&gt;Hercules Q.&lt;/name&gt;</span>
<a name="l00260"></a>00260 <span class="stringliteral">  &lt;/author&gt;</span>
<a name="l00261"></a>00261 <span class="stringliteral">&lt;/entry&gt;</span>
<a name="l00262"></a>00262 <span class="stringliteral">&quot;</span>);
<a name="l00263"></a>00263 
<a name="l00264"></a>00264             XmlWriterSettings xws = <span class="keyword">new</span> XmlWriterSettings();
<a name="l00265"></a>00265             xws.Indent = <span class="keyword">true</span>;
<a name="l00266"></a>00266             XmlWriter xw = XmlWriter.Create(Console.Out);
<a name="l00267"></a>00267             atomResponse.WriteTo(xw);
<a name="l00268"></a>00268             xw.Flush();
<a name="l00269"></a>00269 
<a name="l00270"></a>00270             <a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_atom_reader.html" title="SWORD 2 Atom XML reader.">SwordAtomReader</a> sar = <span class="keyword">new</span> <a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_atom_reader.html" title="SWORD 2 Atom XML reader.">SwordAtomReader</a>(atomResponse);
<a name="l00271"></a>00271             Console.WriteLine(<span class="stringliteral">&quot;EditMediaHref: &quot;</span> + sar.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_atom_reader.html#a471dae35c77f7264764fb7e61acd9cfe" title="Edit media href.">EditMediaHref</a>);
<a name="l00272"></a>00272             Console.WriteLine(<span class="stringliteral">&quot;EditHref: &quot;</span> + sar.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_atom_reader.html#a378cc45a3d02b6a91f58ca0c7a88e166" title="Edit href.">EditHref</a>);
<a name="l00273"></a>00273             Console.WriteLine(<span class="stringliteral">&quot;AtomId: &quot;</span> + sar.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_atom_reader.html#a29dd5db71fe62568fc957a6aa012bf24" title="Atom ID.">AtomId</a>);
<a name="l00274"></a>00274         }
<a name="l00275"></a>00275 
<a name="l00276"></a><a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler_tests.html#a973de41b376aed45c5468ea77570141c">00276</a>         <span class="keyword">private</span> <span class="keywordtype">void</span> TestCreateContainer(<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html" title="SWORD 2 client implementation for .NET.">SwordClientHandler</a> sword2Handler)
<a name="l00277"></a>00277         {
<a name="l00278"></a>00278             <span class="keywordtype">string</span> response = sword2Handler.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#ababdd5115fe9213fb1b2dbb71112356a" title="Creates an empty container on the initialised repository.">CreateContainer</a>();
<a name="l00279"></a>00279             <span class="keywordflow">return</span>;
<a name="l00280"></a>00280         }
<a name="l00281"></a>00281     }
<a name="l00282"></a>00282 }
</pre></div></div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Properties</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Wed Jun 15 2011 08:14:20 for Word 2010 DepositMO plugin - API reference and source guide by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
