<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Word 2010 DepositMO plugin - API reference and source guide: uk.ac.soton.ses.SwordClientHandler Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="classes.html"><span>Class&nbsp;Index</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath">
    <ul>
      <li><a class="el" href="namespaceuk.html">uk</a>      </li>
      <li><a class="el" href="namespaceuk_1_1ac.html">ac</a>      </li>
      <li><a class="el" href="namespaceuk_1_1ac_1_1soton.html">soton</a>      </li>
      <li><a class="el" href="namespaceuk_1_1ac_1_1soton_1_1ses.html">ses</a>      </li>
      <li><a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html">uk.ac.soton.ses.SwordClientHandler</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#properties">Properties</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#pri-static-attribs">Static Private Attributes</a>  </div>
  <div class="headertitle">
<h1>uk.ac.soton.ses.SwordClientHandler Class Reference</h1>  </div>
</div>
<div class="contents">
<!-- doxytag: class="uk::ac::soton::ses::SwordClientHandler" -->
<p>SWORD 2 client implementation for .NET.  
<a href="#_details">More...</a></p>

<p><a href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a040c91a3c203b50d2115152a792e0f5d">SwordClientHandler</a> (string username, string password, string endpoint)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Creates a new SWORD 2 handler instance.  <a href="#a040c91a3c203b50d2115152a792e0f5d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a51a3150690fa0e0ef179f9940bbb4f17">SwordClientHandler</a> (string username, string password, string endpoint, bool resolveInbox)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Creates a new SWORD 2 handler instance.  <a href="#a51a3150690fa0e0ef179f9940bbb4f17"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a67e043a10d08937039c74ab6994280a9">PostDocxToContainer</a> (string docxFilename)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deposits the .docx from the supplied filename to the initialised endpoint with the default content type.  <a href="#a67e043a10d08937039c74ab6994280a9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a1c611b95d09b98c3c0bac8c90cb053ea">PostDocxToContainer</a> (string docxFilename, string contentType)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deposits the .docx from the supplied filename to the initialised endpoint with the supplied content type.  <a href="#a1c611b95d09b98c3c0bac8c90cb053ea"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a0232754a219d1c6d958af13777f229aa">DepositDocxToContents</a> (string docxFilename, string contentType, string contentUri)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deposits the .docx from the supplied filename to the supplied endpoint with the supplied content type.  <a href="#a0232754a219d1c6d958af13777f229aa"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a983f0345d3573e656bbd53bd385cec79">PostDocxToRepository</a> (string docxFilename, string contentType, string endpoint)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Creates a container on the repository and posts the supplied docx file to that container.  <a href="#a983f0345d3573e656bbd53bd385cec79"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a6db06e20d77b596061273903886121a5">PostDocxToRepository</a> (string docxFilename)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Creates a container on the repository and posts the supplied docx file to that container, using the default docx content type and the initialised endpoint on the instance.  <a href="#a6db06e20d77b596061273903886121a5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#aa86f6388db6702248f5411977fe4bd4e">PostDocxToContainer</a> (string docxFilename, string contentType, string containerUri)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Posts the supplied docx file to the supplied container.  <a href="#aa86f6388db6702248f5411977fe4bd4e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#ababdd5115fe9213fb1b2dbb71112356a">CreateContainer</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Creates an empty container on the initialised repository.  <a href="#ababdd5115fe9213fb1b2dbb71112356a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a0d7347dc278f644e302ee6708a5b6562">CreateContainer</a> (string endpoint)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Creates an empty container on the repository at the supplied endpoint.  <a href="#a0d7347dc278f644e302ee6708a5b6562"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#af8f6fb35429f2ce4c60ee210da173ce8">GetResponseLocation</a> (HttpWebRequest wr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets the location of the response from the provided </p>
<div class="fragment"><pre class="fragment">HttpWebRequest
</pre></div>  <a href="#af8f6fb35429f2ce4c60ee210da173ce8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">XmlDocument&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#ae858efe4c9e1bf559f8f6003b581686b">GetEprintInfo</a> (string uri)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets information about the ePrint at the provided URI.  <a href="#ae858efe4c9e1bf559f8f6003b581686b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#af7267ae1dcd8e060bc81f88f4d1d39b3">PutToDocument</a> (string documentFileName, string endpoint)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Performs a PUT to the supplied endpoint with the supplied document filename using </p>
<div class="fragment"><pre class="fragment"><a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a0385ef24a83c1977fa3c12b57ed3da1c" title=".docx content type">DOCX_CONTENTTYPE</a>
</pre></div><p>.  <a href="#af7267ae1dcd8e060bc81f88f4d1d39b3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a69aff38a93d33cb3b2568c840343b58a">PutToDocument</a> (string documentFileName, string endpoint, string contentType)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Performs a PUT to the supplied endpoint with the supplied document filename using the supplied content type.  <a href="#a69aff38a93d33cb3b2568c840343b58a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">XmlDocument&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a6f64cc11c5c3bb44fa6669c6c53f007c">DepositZipToEprint</a> (string zipFileName)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deposits the zip file in the supplied filename to the initialised endpoint with a gzip content type (to be formally standardised at the server side).  <a href="#a6f64cc11c5c3bb44fa6669c6c53f007c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">XmlDocument&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#aacaa059c1c10be869b20e05d86d3323f">DepositZipToEprint</a> (string zipFileName, string contentType)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deposits the zip file in the supplied filename to the initalised endpoint with the supplied content type.  <a href="#aacaa059c1c10be869b20e05d86d3323f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">XmlDocument&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a202cd2ddb02ca36902c8b5b2160f5ae7">DepositEprintsXml</a> (XmlDocument xmlDocument)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deposits the EP2 XML document to the initialised endpoint with X-Packaging type </p>
<div class="fragment"><pre class="fragment"><a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#ae5151720040713916b0eb8c2b640de63" title="EP2 packaging header value.">EP2_PACKAGING</a>
</pre></div>  <a href="#a202cd2ddb02ca36902c8b5b2160f5ae7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">XmlDocument&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a10da15555ed3afe7a9ce5fb6bfec8511">DepositEprintsXml</a> (string xmlFileName)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deposits the EP2 XML document in the supplied filename to the initialised endpoint with X-Packaging type </p>
<div class="fragment"><pre class="fragment"><a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#ae5151720040713916b0eb8c2b640de63" title="EP2 packaging header value.">EP2_PACKAGING</a>
</pre></div>  <a href="#a10da15555ed3afe7a9ce5fb6bfec8511"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">XmlDocument&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a465adaa0ef9f6b6def2a49b66eca4d15">DepositXml</a> (string xmlFileName, string xPackaging)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deposits the XML document in the supplied filename to the initialised endpoint with the supplied X-Packaging type.  <a href="#a465adaa0ef9f6b6def2a49b66eca4d15"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">XmlDocument&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#abbf7fb5bfd6f62957550814ee6394baa">DepositXml</a> (XmlDocument xmlDocument, string xPackaging)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deposits the XML document to the initialised endpoint with the supplied X-Packaging type.  <a href="#abbf7fb5bfd6f62957550814ee6394baa"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">XmlDocument&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a0cfde100b3ab78e06e0fa6c51d1f97e2">Delete</a> (string swordUrl)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deletes the document at the target address </p>
<div class="fragment"><pre class="fragment">swordUrl
</pre></div><p>.  <a href="#a0cfde100b3ab78e06e0fa6c51d1f97e2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">XmlDocument&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a18701ccda5403431fa3ead1d8ce05017">ListRecords</a> (bool stripEndpoint)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">List all records at the endpoint.  <a href="#a18701ccda5403431fa3ead1d8ce05017"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">XmlDocument&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a2710ceb77df367ab00b0a38fd8608c57">ListRecords</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">List all records at the endpoint, by calling endpoint/id/records (</p>
<div class="fragment"><pre class="fragment"><a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a69cc508a1fb745ebc36328c65747b936" title="The path for listing records.">LIST_RECORD_PATH</a>
</pre></div><p>).  <a href="#a2710ceb77df367ab00b0a38fd8608c57"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="properties"></a>
Properties</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a33c1db88d01e26235f6ffbf9888696f9">Username</a><code> [set]</code></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sets the username associated with the repository.  <a href="#a33c1db88d01e26235f6ffbf9888696f9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#ade1862c2c508cc4a1c5007ee01e9ccc5">Password</a><code> [set]</code></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sets the password associated with the repository.  <a href="#ade1862c2c508cc4a1c5007ee01e9ccc5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#ace1337ce98ce3433b17bee6484e2a037">Endpoint</a><code> [set]</code></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sets the endpoint associated with the repository.  <a href="#ace1337ce98ce3433b17bee6484e2a037"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">internal void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#af74880abd60b9ca07bdbeb69207a6052">ResolveInbox</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Resolves the inbox based on the currently-supplied endpoint.  <a href="#af74880abd60b9ca07bdbeb69207a6052"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">HttpWebRequest&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a3de286f71c510cf85f1e6e093f1979fb">GetBasicAuthAtomWebRequest</a> (string targetUri)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Creates a web request instance to the target URI, adding in basic authorisation from the username and password on the instance, and setting the </p>
<div class="fragment"><pre class="fragment">accept
</pre></div><p> header of the request to be </p>
<div class="fragment"><pre class="fragment">application/atom+xml
</pre></div>  <a href="#a3de286f71c510cf85f1e6e093f1979fb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">HttpWebRequest&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#ada064ec7e02354c3cd4b4a9bcd644559">GetBasicAuthAtomWebRequest</a> (Uri targetUri)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Creates a web request instance to the target URI, adding in basic authorisation from the username and password on the instance, and setting the </p>
<div class="fragment"><pre class="fragment">accept
</pre></div><p> header of the request to be </p>
<div class="fragment"><pre class="fragment">application/atom+xml
</pre></div>  <a href="#ada064ec7e02354c3cd4b4a9bcd644559"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a5de096e263959293cbeae7b18a28fc1c">WriteFileToRequest</a> (string filename, HttpWebRequest wr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Writes the file in </p>
<div class="fragment"><pre class="fragment">filename
</pre></div><p> to the web request </p>
<div class="fragment"><pre class="fragment">wr
</pre></div><p>.  <a href="#a5de096e263959293cbeae7b18a28fc1c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">XmlDocument&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#ae32b5ee95e02c60599efca34cd2b032e">GetXmlResponse</a> (HttpWebRequest wr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets an XML document as the response from a web request.  <a href="#ae32b5ee95e02c60599efca34cd2b032e"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">internal bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a9e50e2fb359bcae16dbd2e39dccfe493">_resolveInbox</a> = false</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">TODO: Whether the inbox URL should be resolved from the HTML of the supplied endpoint.  <a href="#a9e50e2fb359bcae16dbd2e39dccfe493"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a5dc115a3a462fa648848dc202bcc6825">_username</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The repository username.  <a href="#a5dc115a3a462fa648848dc202bcc6825"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a9bb60533f7724e9de9e0a3250b8a6766">_password</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The repository password.  <a href="#a9bb60533f7724e9de9e0a3250b8a6766"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a64864c6788f03c793c360a22213f608b">_endpoint</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The main repository endpoint.  <a href="#a64864c6788f03c793c360a22213f608b"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pri-static-attribs"></a>
Static Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a478b92910f3fa8781498c163599f5b26">BUFFER_SIZE</a> = 16 * 1024</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Buffer size for uploads in bytes.  <a href="#a478b92910f3fa8781498c163599f5b26"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#ae5151720040713916b0eb8c2b640de63">EP2_PACKAGING</a> = &quot;http://eprints.org/ep2/data/2.0&quot;</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">EP2 packaging header value.  <a href="#ae5151720040713916b0eb8c2b640de63"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a0385ef24a83c1977fa3c12b57ed3da1c">DOCX_CONTENTTYPE</a> = &quot;application/vnd.openxmlformats-officedocument.wordprocessingml.document&quot;</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">.docx content type  <a href="#a0385ef24a83c1977fa3c12b57ed3da1c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a69cc508a1fb745ebc36328c65747b936">LIST_RECORD_PATH</a> = &quot;/id/records&quot;</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The path for listing records.  <a href="#a69cc508a1fb745ebc36328c65747b936"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a73b47f940f995590abe3530d99972375">EXTRACT_MEDIA</a> = &quot;true&quot;</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Should media be extracted by default, or ignored? Note that this is going into a header so it should be a string rather than a Boolean.  <a href="#a73b47f940f995590abe3530d99972375"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>SWORD 2 client implementation for .NET. </p>
<p>Library functions for communicating with a SWORD 2 compliant server </p>

<p>Definition at line <a class="el" href="_sword_client_handler_8cs_source.html#l00035">35</a> of file <a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a>.</p>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a040c91a3c203b50d2115152a792e0f5d"></a><!-- doxytag: member="uk::ac::soton::ses::SwordClientHandler::SwordClientHandler" ref="a040c91a3c203b50d2115152a792e0f5d" args="(string username, string password, string endpoint)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uk.ac.soton.ses.SwordClientHandler.SwordClientHandler </td>
          <td>(</td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>username</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>endpoint</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Creates a new SWORD 2 handler instance. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>username</em>&nbsp;</td><td>The repository username</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>password</em>&nbsp;</td><td>The repository password</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>endpoint</em>&nbsp;</td><td>The main repository endpoint</td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_sword_client_handler_8cs_source.html#l00124">124</a> of file <a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a>.</p>

<p><div class="fragment"><pre class="fragment">        {
            this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a5dc115a3a462fa648848dc202bcc6825" title="The repository username.">_username</a> = username;
            this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a9bb60533f7724e9de9e0a3250b8a6766" title="The repository password.">_password</a> = password;
            this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a64864c6788f03c793c360a22213f608b" title="The main repository endpoint.">_endpoint</a> = endpoint;
        }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a51a3150690fa0e0ef179f9940bbb4f17"></a><!-- doxytag: member="uk::ac::soton::ses::SwordClientHandler::SwordClientHandler" ref="a51a3150690fa0e0ef179f9940bbb4f17" args="(string username, string password, string endpoint, bool resolveInbox)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uk.ac.soton.ses.SwordClientHandler.SwordClientHandler </td>
          <td>(</td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>username</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>endpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>resolveInbox</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Creates a new SWORD 2 handler instance. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>username</em>&nbsp;</td><td>The repository username</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>password</em>&nbsp;</td><td>The repository password</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>endpoint</em>&nbsp;</td><td>The main repository endpoint</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>resolveInbox</em>&nbsp;</td><td>Whether to attempt to resolve the 'inbox' from the supplied endpoint</td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_sword_client_handler_8cs_source.html#l00138">138</a> of file <a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a>.</p>

<p><div class="fragment"><pre class="fragment">        {
            this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a5dc115a3a462fa648848dc202bcc6825" title="The repository username.">_username</a> = username;
            this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a9bb60533f7724e9de9e0a3250b8a6766" title="The repository password.">_password</a> = password;
            this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a64864c6788f03c793c360a22213f608b" title="The main repository endpoint.">_endpoint</a> = endpoint;
            this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a9e50e2fb359bcae16dbd2e39dccfe493" title="TODO: Whether the inbox URL should be resolved from the HTML of the supplied endpoint.">_resolveInbox</a> = resolveInbox;
            this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#af74880abd60b9ca07bdbeb69207a6052" title="Resolves the inbox based on the currently-supplied endpoint.">ResolveInbox</a>();
        }
</pre></div></p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="ababdd5115fe9213fb1b2dbb71112356a"></a><!-- doxytag: member="uk::ac::soton::ses::SwordClientHandler::CreateContainer" ref="ababdd5115fe9213fb1b2dbb71112356a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string uk.ac.soton.ses.SwordClientHandler.CreateContainer </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Creates an empty container on the initialised repository. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>The address of the new empty container</dd></dl>

<p>Definition at line <a class="el" href="_sword_client_handler_8cs_source.html#l00381">381</a> of file <a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a>.</p>

<p>Referenced by <a class="el" href="_sword_client_handler_tests_8cs_source.html#l00276">uk.ac.soton.ses.SwordClientHandlerTests.TestCreateContainer()</a>.</p>

<p><div class="fragment"><pre class="fragment">        {
            <span class="keywordflow">return</span> this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#ababdd5115fe9213fb1b2dbb71112356a" title="Creates an empty container on the initialised repository.">CreateContainer</a>(this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a64864c6788f03c793c360a22213f608b" title="The main repository endpoint.">_endpoint</a>);
        }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a0d7347dc278f644e302ee6708a5b6562"></a><!-- doxytag: member="uk::ac::soton::ses::SwordClientHandler::CreateContainer" ref="a0d7347dc278f644e302ee6708a5b6562" args="(string endpoint)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string uk.ac.soton.ses.SwordClientHandler.CreateContainer </td>
          <td>(</td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>endpoint</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Creates an empty container on the repository at the supplied endpoint. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>endpoint</em>&nbsp;</td><td>The endpoint at which to create the new empty container</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The address of the new empty container</dd></dl>

<p>Definition at line <a class="el" href="_sword_client_handler_8cs_source.html#l00391">391</a> of file <a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a>.</p>

<p><div class="fragment"><pre class="fragment">        {
            HttpWebRequest wr = this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a3de286f71c510cf85f1e6e093f1979fb" title="Creates a web request instance to the target URI, adding in basic authorisation from the username and...">GetBasicAuthAtomWebRequest</a>(endpoint);
            wr.Method = <span class="stringliteral">&quot;POST&quot;</span>;
            wr.ContentType = <span class="stringliteral">&quot;application/atom+xml&quot;</span>;
            wr.Headers.Add(<span class="stringliteral">&quot;In-Progress&quot;</span>, <span class="stringliteral">&quot;true&quot;</span>);
            <span class="keywordtype">string</span> emptyAtom = <span class="stringliteral">@&quot;&lt;?xml version=&quot;&quot;1.0&quot;&quot; encoding=&quot;&quot;utf-8&quot;&quot; ?&gt;</span>
<span class="stringliteral">             &lt;entry xmlns=&quot;&quot;http://www.w3.org/2005/Atom&quot;&quot; /&gt;&quot;</span>;
            wr.ContentLength = (long)emptyAtom.Length;
            
            <span class="comment">// TODO: not the most elegant way to write this &#39;empty&#39; Atom request</span>
            <span class="comment">// but functional</span>
            using (Stream requestStream = wr.GetRequestStream())
            {
                <span class="keywordflow">foreach</span> (byte b <span class="keywordflow">in</span> emptyAtom)
                {
                    requestStream.WriteByte(b);
                }    
            }

            <span class="keywordflow">return</span> this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#af8f6fb35429f2ce4c60ee210da173ce8" title="Gets the location of the response from the provided HttpWebRequest">GetResponseLocation</a>(wr);
        }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a0cfde100b3ab78e06e0fa6c51d1f97e2"></a><!-- doxytag: member="uk::ac::soton::ses::SwordClientHandler::Delete" ref="a0cfde100b3ab78e06e0fa6c51d1f97e2" args="(string swordUrl)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">XmlDocument uk.ac.soton.ses.SwordClientHandler.Delete </td>
          <td>(</td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>swordUrl</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Deletes the document at the target address </p>
<div class="fragment"><pre class="fragment">swordUrl
</pre></div><p>. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>swordUrl</em>&nbsp;</td><td>The target address at which the document resides</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Atom response</dd></dl>

<p>Definition at line <a class="el" href="_sword_client_handler_8cs_source.html#l00613">613</a> of file <a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a>.</p>

<p>Referenced by <a class="el" href="_sword_client_handler_tests_8cs_source.html#l00124">uk.ac.soton.ses.SwordClientHandlerTests.TestDelete()</a>.</p>

<p><div class="fragment"><pre class="fragment">        {
            HttpWebRequest wr = this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a3de286f71c510cf85f1e6e093f1979fb" title="Creates a web request instance to the target URI, adding in basic authorisation from the username and...">GetBasicAuthAtomWebRequest</a>(swordUrl);
            wr.Method = <span class="stringliteral">&quot;DELETE&quot;</span>;
            <span class="keywordflow">return</span> this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#ae32b5ee95e02c60599efca34cd2b032e" title="Gets an XML document as the response from a web request.">GetXmlResponse</a>(wr);
        }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a0232754a219d1c6d958af13777f229aa"></a><!-- doxytag: member="uk::ac::soton::ses::SwordClientHandler::DepositDocxToContents" ref="a0232754a219d1c6d958af13777f229aa" args="(string docxFilename, string contentType, string contentUri)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string uk.ac.soton.ses.SwordClientHandler.DepositDocxToContents </td>
          <td>(</td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>docxFilename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>contentType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>contentUri</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Deposits the .docx from the supplied filename to the supplied endpoint with the supplied content type. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>docxFilename</em>&nbsp;</td><td>The filename of the .docx to deposit</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>contentType</em>&nbsp;</td><td>The content type to use for the deposition</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>contentUri</em>&nbsp;</td><td>The endpoint against which the deposition should occur</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Atom response</dd></dl>

<p>Definition at line <a class="el" href="_sword_client_handler_8cs_source.html#l00299">299</a> of file <a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a>.</p>

<p><div class="fragment"><pre class="fragment">        {            
            FileInfo fi = <span class="keyword">new</span> FileInfo(docxFilename);            
            HttpWebRequest wr = this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a3de286f71c510cf85f1e6e093f1979fb" title="Creates a web request instance to the target URI, adding in basic authorisation from the username and...">GetBasicAuthAtomWebRequest</a>(contentUri);

            wr.Method = <span class="stringliteral">&quot;POST&quot;</span>;
            wr.Headers.Add(<span class="stringliteral">&quot;Content-Disposition&quot;</span>, <span class="stringliteral">&quot;form-data; name=\&quot;&quot;</span> + fi.Name + <span class="stringliteral">&quot;\&quot;; filename=\&quot;&quot;</span> + fi.Name + <span class="stringliteral">&quot;\&quot;&quot;</span>);           
            wr.ContentType = contentType;
            wr.ContentLength = fi.Length;
            <span class="comment">// should the default be to extract media, or ignore it?</span>
            wr.Headers.Add(<span class="stringliteral">&quot;X-Extract-Media&quot;</span>, <a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a73b47f940f995590abe3530d99972375" title="Should media be extracted by default, or ignored? Note that this is going into a header so it should ...">EXTRACT_MEDIA</a>);
            wr.Headers.Add(<span class="stringliteral">&quot;X-Override-Metadata&quot;</span>, <span class="stringliteral">&quot;true&quot;</span>);
            <span class="comment">//wr.Headers.Add(&quot;Metadata-Relevant&quot;, &quot;true&quot;);</span>
            wr.Headers.Add(<span class="stringliteral">&quot;In-Progress&quot;</span>, <span class="stringliteral">&quot;true&quot;</span>);
            this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a5de096e263959293cbeae7b18a28fc1c" title="Writes the file in filename to the web request wr.">WriteFileToRequest</a>(docxFilename, wr);

            <span class="keywordflow">return</span> this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#af8f6fb35429f2ce4c60ee210da173ce8" title="Gets the location of the response from the provided HttpWebRequest">GetResponseLocation</a>(wr); <span class="comment">//this.GetXmlResponse(wr);</span>
        }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a202cd2ddb02ca36902c8b5b2160f5ae7"></a><!-- doxytag: member="uk::ac::soton::ses::SwordClientHandler::DepositEprintsXml" ref="a202cd2ddb02ca36902c8b5b2160f5ae7" args="(XmlDocument xmlDocument)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">XmlDocument uk.ac.soton.ses.SwordClientHandler.DepositEprintsXml </td>
          <td>(</td>
          <td class="paramtype">XmlDocument&nbsp;</td>
          <td class="paramname"> <em>xmlDocument</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Deposits the EP2 XML document to the initialised endpoint with X-Packaging type </p>
<div class="fragment"><pre class="fragment"><a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#ae5151720040713916b0eb8c2b640de63" title="EP2 packaging header value.">EP2_PACKAGING</a>
</pre></div> </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>xmlDocument</em>&nbsp;</td><td>The EP2 XML document to deposit</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Atom response</dd></dl>

<p>Definition at line <a class="el" href="_sword_client_handler_8cs_source.html#l00545">545</a> of file <a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a>.</p>

<p>Referenced by <a class="el" href="_sword_client_handler_tests_8cs_source.html#l00190">uk.ac.soton.ses.SwordClientHandlerTests.TestDepositEprintsXml()</a>.</p>

<p><div class="fragment"><pre class="fragment">        {
            <span class="keywordflow">return</span> this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a465adaa0ef9f6b6def2a49b66eca4d15" title="Deposits the XML document in the supplied filename to the initialised endpoint with the supplied X-Pa...">DepositXml</a>(xmlDocument, <a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#ae5151720040713916b0eb8c2b640de63" title="EP2 packaging header value.">EP2_PACKAGING</a>);
        }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a10da15555ed3afe7a9ce5fb6bfec8511"></a><!-- doxytag: member="uk::ac::soton::ses::SwordClientHandler::DepositEprintsXml" ref="a10da15555ed3afe7a9ce5fb6bfec8511" args="(string xmlFileName)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">XmlDocument uk.ac.soton.ses.SwordClientHandler.DepositEprintsXml </td>
          <td>(</td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>xmlFileName</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Deposits the EP2 XML document in the supplied filename to the initialised endpoint with X-Packaging type </p>
<div class="fragment"><pre class="fragment"><a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#ae5151720040713916b0eb8c2b640de63" title="EP2 packaging header value.">EP2_PACKAGING</a>
</pre></div> </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>xmlFileName</em>&nbsp;</td><td>The filename of the EP2 XML document to deposit</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Atom response</dd></dl>

<p>Definition at line <a class="el" href="_sword_client_handler_8cs_source.html#l00556">556</a> of file <a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a>.</p>

<p><div class="fragment"><pre class="fragment">        {
            <span class="keywordflow">return</span> this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a465adaa0ef9f6b6def2a49b66eca4d15" title="Deposits the XML document in the supplied filename to the initialised endpoint with the supplied X-Pa...">DepositXml</a>(xmlFileName, <a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#ae5151720040713916b0eb8c2b640de63" title="EP2 packaging header value.">EP2_PACKAGING</a>);
        }
</pre></div></p>

</div>
</div>
<a class="anchor" id="abbf7fb5bfd6f62957550814ee6394baa"></a><!-- doxytag: member="uk::ac::soton::ses::SwordClientHandler::DepositXml" ref="abbf7fb5bfd6f62957550814ee6394baa" args="(XmlDocument xmlDocument, string xPackaging)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">XmlDocument uk.ac.soton.ses.SwordClientHandler.DepositXml </td>
          <td>(</td>
          <td class="paramtype">XmlDocument&nbsp;</td>
          <td class="paramname"> <em>xmlDocument</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>xPackaging</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Deposits the XML document to the initialised endpoint with the supplied X-Packaging type. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>xmlDocument</em>&nbsp;</td><td>The XML document to deposit</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>xPackaging</em>&nbsp;</td><td>The X-Packaging type</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Atom response</dd></dl>

<p>Definition at line <a class="el" href="_sword_client_handler_8cs_source.html#l00582">582</a> of file <a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a>.</p>

<p><div class="fragment"><pre class="fragment">        {            
            HttpWebRequest wr = this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a3de286f71c510cf85f1e6e093f1979fb" title="Creates a web request instance to the target URI, adding in basic authorisation from the username and...">GetBasicAuthAtomWebRequest</a>(this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a64864c6788f03c793c360a22213f608b" title="The main repository endpoint.">_endpoint</a>);            
            wr.Method = <span class="stringliteral">&quot;POST&quot;</span>;
            wr.Headers.Add(<span class="stringliteral">&quot;X-Packaging&quot;</span>, xPackaging);
            wr.ContentType = <span class="stringliteral">&quot;text/xml&quot;</span>;

            <span class="comment">// note that we can&#39;t wrap the Stream here with a using as there</span>
            <span class="comment">// is a possibility that Dispose will get called more than once</span>
            <span class="comment">// and this will generate an ObjectDisposedException. Instead,</span>
            <span class="comment">// we&#39;ll not assign the request stream to anything and just</span>
            <span class="comment">// pass it through directly</span>

            XmlWriterSettings xws = <span class="keyword">new</span> XmlWriterSettings();
            xws.CloseOutput = <span class="keyword">true</span>;            
            
            <span class="keyword">using</span> (XmlWriter xw = XmlWriter.Create(wr.GetRequestStream(), xws))
            {
                xmlDocument.WriteTo(xw);

                <span class="comment">// ensure that the XML writer is flushes as this does *not* happen automatically</span>
                xw.Flush();
            }            
            <span class="keywordflow">return</span> this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#ae32b5ee95e02c60599efca34cd2b032e" title="Gets an XML document as the response from a web request.">GetXmlResponse</a>(wr);
        }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a465adaa0ef9f6b6def2a49b66eca4d15"></a><!-- doxytag: member="uk::ac::soton::ses::SwordClientHandler::DepositXml" ref="a465adaa0ef9f6b6def2a49b66eca4d15" args="(string xmlFileName, string xPackaging)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">XmlDocument uk.ac.soton.ses.SwordClientHandler.DepositXml </td>
          <td>(</td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>xmlFileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>xPackaging</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Deposits the XML document in the supplied filename to the initialised endpoint with the supplied X-Packaging type. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>xmlFileName</em>&nbsp;</td><td>The filename of the XML document to deposit</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>xPackaging</em>&nbsp;</td><td>The X-Packaging type</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Atom response</dd></dl>

<p>Definition at line <a class="el" href="_sword_client_handler_8cs_source.html#l00568">568</a> of file <a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a>.</p>

<p><div class="fragment"><pre class="fragment">        {
            XmlDocument xmlDocument = <span class="keyword">new</span> XmlDocument();
            xmlDocument.Load(xmlFileName);
            <span class="keywordflow">return</span> this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a465adaa0ef9f6b6def2a49b66eca4d15" title="Deposits the XML document in the supplied filename to the initialised endpoint with the supplied X-Pa...">DepositXml</a>(xmlDocument, xPackaging);
        }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aacaa059c1c10be869b20e05d86d3323f"></a><!-- doxytag: member="uk::ac::soton::ses::SwordClientHandler::DepositZipToEprint" ref="aacaa059c1c10be869b20e05d86d3323f" args="(string zipFileName, string contentType)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">XmlDocument uk.ac.soton.ses.SwordClientHandler.DepositZipToEprint </td>
          <td>(</td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>zipFileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>contentType</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Deposits the zip file in the supplied filename to the initalised endpoint with the supplied content type. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>zipFileName</em>&nbsp;</td><td>The zip filename</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>contentType</em>&nbsp;</td><td>The content type</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Atom response</dd></dl>

<p>Definition at line <a class="el" href="_sword_client_handler_8cs_source.html#l00525">525</a> of file <a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a>.</p>

<p><div class="fragment"><pre class="fragment">        {         
            FileInfo fi = <span class="keyword">new</span> FileInfo(zipFileName);            
            HttpWebRequest wr = this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a3de286f71c510cf85f1e6e093f1979fb" title="Creates a web request instance to the target URI, adding in basic authorisation from the username and...">GetBasicAuthAtomWebRequest</a>(this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a64864c6788f03c793c360a22213f608b" title="The main repository endpoint.">_endpoint</a>);
            wr.Method = <span class="stringliteral">&quot;POST&quot;</span>;            
            wr.Headers.Add(<span class="stringliteral">&quot;Content-Disposition&quot;</span>, <span class="stringliteral">&quot;form-data; name=\&quot;&quot;</span> + fi.Name + <span class="stringliteral">&quot;\&quot;; filename=\&quot;&quot;</span> + fi.Name + <span class="stringliteral">&quot;\&quot;&quot;</span>);            
            wr.ContentType = contentType;
            wr.ContentLength = fi.Length;
            wr.Headers.Add(<span class="stringliteral">&quot;X-Extract-Archive&quot;</span>, <span class="stringliteral">&quot;true&quot;</span>);
            this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a5de096e263959293cbeae7b18a28fc1c" title="Writes the file in filename to the web request wr.">WriteFileToRequest</a>(zipFileName, wr);

            <span class="keywordflow">return</span> this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#ae32b5ee95e02c60599efca34cd2b032e" title="Gets an XML document as the response from a web request.">GetXmlResponse</a>(wr);
        }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6f64cc11c5c3bb44fa6669c6c53f007c"></a><!-- doxytag: member="uk::ac::soton::ses::SwordClientHandler::DepositZipToEprint" ref="a6f64cc11c5c3bb44fa6669c6c53f007c" args="(string zipFileName)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">XmlDocument uk.ac.soton.ses.SwordClientHandler.DepositZipToEprint </td>
          <td>(</td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>zipFileName</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Deposits the zip file in the supplied filename to the initialised endpoint with a gzip content type (to be formally standardised at the server side). </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>zipFileName</em>&nbsp;</td><td>The zip filename</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Atom response</dd></dl>

<p>Definition at line <a class="el" href="_sword_client_handler_8cs_source.html#l00513">513</a> of file <a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a>.</p>

<p>Referenced by <a class="el" href="_sword_client_handler_tests_8cs_source.html#l00182">uk.ac.soton.ses.SwordClientHandlerTests.TestDepositZipToEprint()</a>.</p>

<p><div class="fragment"><pre class="fragment">        {
            <span class="keywordflow">return</span> this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a6f64cc11c5c3bb44fa6669c6c53f007c" title="Deposits the zip file in the supplied filename to the initialised endpoint with a gzip content type (...">DepositZipToEprint</a>(zipFileName, <span class="stringliteral">&quot;application/g-zip&quot;</span>);
        }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3de286f71c510cf85f1e6e093f1979fb"></a><!-- doxytag: member="uk::ac::soton::ses::SwordClientHandler::GetBasicAuthAtomWebRequest" ref="a3de286f71c510cf85f1e6e093f1979fb" args="(string targetUri)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HttpWebRequest uk.ac.soton.ses.SwordClientHandler.GetBasicAuthAtomWebRequest </td>
          <td>(</td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>targetUri</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Creates a web request instance to the target URI, adding in basic authorisation from the username and password on the instance, and setting the </p>
<div class="fragment"><pre class="fragment">accept
</pre></div><p> header of the request to be </p>
<div class="fragment"><pre class="fragment">application/atom+xml
</pre></div> </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>targetUri</em>&nbsp;</td><td>The URI to which the request should be made</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Web request</dd></dl>

<p>Definition at line <a class="el" href="_sword_client_handler_8cs_source.html#l00173">173</a> of file <a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a>.</p>

<p><div class="fragment"><pre class="fragment">        {
            <span class="keywordflow">return</span> this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a3de286f71c510cf85f1e6e093f1979fb" title="Creates a web request instance to the target URI, adding in basic authorisation from the username and...">GetBasicAuthAtomWebRequest</a>(<span class="keyword">new</span> Uri(targetUri));
        }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ada064ec7e02354c3cd4b4a9bcd644559"></a><!-- doxytag: member="uk::ac::soton::ses::SwordClientHandler::GetBasicAuthAtomWebRequest" ref="ada064ec7e02354c3cd4b4a9bcd644559" args="(Uri targetUri)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HttpWebRequest uk.ac.soton.ses.SwordClientHandler.GetBasicAuthAtomWebRequest </td>
          <td>(</td>
          <td class="paramtype">Uri&nbsp;</td>
          <td class="paramname"> <em>targetUri</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Creates a web request instance to the target URI, adding in basic authorisation from the username and password on the instance, and setting the </p>
<div class="fragment"><pre class="fragment">accept
</pre></div><p> header of the request to be </p>
<div class="fragment"><pre class="fragment">application/atom+xml
</pre></div> </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>targetUri</em>&nbsp;</td><td>The URI to which the request should be made</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Web request</dd></dl>

<p>Definition at line <a class="el" href="_sword_client_handler_8cs_source.html#l00185">185</a> of file <a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a>.</p>

<p><div class="fragment"><pre class="fragment">        {
            HttpWebRequest request = (HttpWebRequest)WebRequest.Create(targetUri);
            CredentialCache cc = <span class="keyword">new</span> CredentialCache();
            cc.Add(targetUri, <span class="stringliteral">&quot;Basic&quot;</span>, <span class="keyword">new</span> NetworkCredential(this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a5dc115a3a462fa648848dc202bcc6825" title="The repository username.">_username</a>, this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a9bb60533f7724e9de9e0a3250b8a6766" title="The repository password.">_password</a>, <span class="stringliteral">&quot;Authenticate&quot;</span>));                 
            <span class="comment">//cc.Add(new Uri(targetUri), &quot;Basic&quot;, new NetworkCredential(this._username, this._password));                 </span>
            request.Credentials = cc;            
            request.Headers.Add(HttpRequestHeader.Authorization, <span class="stringliteral">&quot;Basic &quot;</span> + Convert.ToBase64String(<span class="keyword">new</span> ASCIIEncoding().GetBytes(this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a5dc115a3a462fa648848dc202bcc6825" title="The repository username.">_username</a> + <span class="charliteral">&#39;:&#39;</span> + this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a9bb60533f7724e9de9e0a3250b8a6766" title="The repository password.">_password</a>)));
            request.Accept = <span class="stringliteral">&quot;application/atom+xml&quot;</span>;
            <span class="keywordflow">return</span> request;
        }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae858efe4c9e1bf559f8f6003b581686b"></a><!-- doxytag: member="uk::ac::soton::ses::SwordClientHandler::GetEprintInfo" ref="ae858efe4c9e1bf559f8f6003b581686b" args="(string uri)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">XmlDocument uk.ac.soton.ses.SwordClientHandler.GetEprintInfo </td>
          <td>(</td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>uri</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Gets information about the ePrint at the provided URI. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>uri</em>&nbsp;</td><td>ePrint URI</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Atom XML document</dd></dl>

<p>Definition at line <a class="el" href="_sword_client_handler_8cs_source.html#l00434">434</a> of file <a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a>.</p>

<p>Referenced by <a class="el" href="_sword_client_handler_tests_8cs_source.html#l00200">uk.ac.soton.ses.SwordClientHandlerTests.TestGetInfo()</a>.</p>

<p><div class="fragment"><pre class="fragment">        {
            HttpWebRequest wr = this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a3de286f71c510cf85f1e6e093f1979fb" title="Creates a web request instance to the target URI, adding in basic authorisation from the username and...">GetBasicAuthAtomWebRequest</a>(uri);
            wr.Method = <span class="stringliteral">&quot;GET&quot;</span>;
            <span class="keywordflow">return</span> this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#ae32b5ee95e02c60599efca34cd2b032e" title="Gets an XML document as the response from a web request.">GetXmlResponse</a>(wr);
        }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af8f6fb35429f2ce4c60ee210da173ce8"></a><!-- doxytag: member="uk::ac::soton::ses::SwordClientHandler::GetResponseLocation" ref="af8f6fb35429f2ce4c60ee210da173ce8" args="(HttpWebRequest wr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string uk.ac.soton.ses.SwordClientHandler.GetResponseLocation </td>
          <td>(</td>
          <td class="paramtype">HttpWebRequest&nbsp;</td>
          <td class="paramname"> <em>wr</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Gets the location of the response from the provided </p>
<div class="fragment"><pre class="fragment">HttpWebRequest
</pre></div> </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>wr</em>&nbsp;</td><td>The web request to query</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Location string</dd></dl>

<p>Definition at line <a class="el" href="_sword_client_handler_8cs_source.html#l00419">419</a> of file <a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a>.</p>

<p><div class="fragment"><pre class="fragment">        {
            <span class="keywordtype">string</span> location = null;
            <span class="keyword">using</span> (HttpWebResponse resp = (HttpWebResponse)wr.GetResponse())
            {
                location = resp.Headers[HttpResponseHeader.Location].ToString();
            }
            <span class="keywordflow">return</span> location;
        }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae32b5ee95e02c60599efca34cd2b032e"></a><!-- doxytag: member="uk::ac::soton::ses::SwordClientHandler::GetXmlResponse" ref="ae32b5ee95e02c60599efca34cd2b032e" args="(HttpWebRequest wr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">XmlDocument uk.ac.soton.ses.SwordClientHandler.GetXmlResponse </td>
          <td>(</td>
          <td class="paramtype">HttpWebRequest&nbsp;</td>
          <td class="paramname"> <em>wr</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Gets an XML document as the response from a web request. </p>
<p>The response will be </p>
<div class="fragment"><pre class="fragment">null
</pre></div><p> if it is invalid, either because it is not well-formed XML (e.g. HTML 4.0) or there was no acceptable response available from the server (e.g. 404)</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>wr</em>&nbsp;</td><td>The web request from which the response should be requested</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The XML document response</dd></dl>

<p>Definition at line <a class="el" href="_sword_client_handler_8cs_source.html#l00232">232</a> of file <a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a>.</p>

<p><div class="fragment"><pre class="fragment">        {
            XmlDocument xmlResponse = null;

            <span class="keywordflow">try</span>
            {
                <span class="keyword">using</span> (WebResponse res = wr.GetResponse())
                {
                    <span class="keyword">using</span> (Stream resStream = res.GetResponseStream())
                    {
                        <span class="comment">// when this method was implemented, the SWORD 2 server was still returning HTML:</span>
                        <span class="comment">// if (((HttpWebResponse)res).StatusCode == HttpStatusCode.OK)</span>
                        <span class="comment">// {</span>
                        <span class="comment">//    return null;</span>
                        <span class="comment">// }</span>
                        <span class="comment">// - so try/catch this in case it changes</span>
                                                    
                        <span class="keywordflow">try</span>
                        {
                            xmlResponse = <span class="keyword">new</span> XmlDocument();
                            xmlResponse.Load(resStream);
                        }
                        <span class="keywordflow">catch</span> (XmlException xex)
                        {
                            Debug.WriteLine(xex);
                            <span class="comment">// xmlResponse = null; // depends how we want to handle this</span>
                        }
                    }
                }
            }
            <span class="keywordflow">catch</span> (WebException wex)
            {
                <span class="comment">// likely a 404, write the exception if we&#39;re in debug mode, and fall through</span>
                <span class="comment">// to return the null response</span>
                Debug.WriteLine(wex);
            }
            <span class="keywordflow">return</span> xmlResponse;
        }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2710ceb77df367ab00b0a38fd8608c57"></a><!-- doxytag: member="uk::ac::soton::ses::SwordClientHandler::ListRecords" ref="a2710ceb77df367ab00b0a38fd8608c57" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">XmlDocument uk.ac.soton.ses.SwordClientHandler.ListRecords </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>List all records at the endpoint, by calling endpoint/id/records (</p>
<div class="fragment"><pre class="fragment"><a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a69cc508a1fb745ebc36328c65747b936" title="The path for listing records.">LIST_RECORD_PATH</a>
</pre></div><p>). </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>List of records in XML format, else <div class="fragment"><pre class="fragment">null
</pre></div></dd></dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>WebException</em>&nbsp;</td><td>Typically thrown at a timeout on the endpoint</td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_sword_client_handler_8cs_source.html#l00695">695</a> of file <a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a>.</p>

<p><div class="fragment"><pre class="fragment">        {
            <span class="keywordflow">return</span> this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a2710ceb77df367ab00b0a38fd8608c57" title="List all records at the endpoint, by calling endpoint/id/records (LIST_RECORD_PATH).">ListRecords</a>(<span class="keyword">false</span>);
        }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a18701ccda5403431fa3ead1d8ce05017"></a><!-- doxytag: member="uk::ac::soton::ses::SwordClientHandler::ListRecords" ref="a18701ccda5403431fa3ead1d8ce05017" args="(bool stripEndpoint)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">XmlDocument uk.ac.soton.ses.SwordClientHandler.ListRecords </td>
          <td>(</td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>stripEndpoint</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>List all records at the endpoint. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>stripEndpoint</em>&nbsp;</td><td><div class="fragment"><pre class="fragment"><span class="keyword">true</span>
</pre></div><p> if the endpoint should be stripped down and the default of /id/records (</p>
<div class="fragment"><pre class="fragment"><a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a69cc508a1fb745ebc36328c65747b936" title="The path for listing records.">LIST_RECORD_PATH</a>
</pre></div><p>) used, else </p>
<div class="fragment"><pre class="fragment"><span class="keyword">false</span>
</pre></div><p> if the literal endpoint, suffixed with /id/records (</p>
<div class="fragment"><pre class="fragment"><a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a69cc508a1fb745ebc36328c65747b936" title="The path for listing records.">LIST_RECORD_PATH</a>
</pre></div><p>) value should be used</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>List of records in XML format, else <div class="fragment"><pre class="fragment">null
</pre></div></dd></dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>WebException</em>&nbsp;</td><td>Typically thrown at a timeout on the endpoint</td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_sword_client_handler_8cs_source.html#l00629">629</a> of file <a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a>.</p>

<p>Referenced by <a class="el" href="_deposit_m_o_repository_control_8cs_source.html#l00314">uk.ac.soton.ses.Word2010DepositMOAddIn.DepositMORepositoryControl.DumpListingToLog()</a>, and <a class="el" href="_sword_client_handler_tests_8cs_source.html#l00210">uk.ac.soton.ses.SwordClientHandlerTests.TestList()</a>.</p>

<p><div class="fragment"><pre class="fragment">        {
            <span class="keywordtype">string</span> target = this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a64864c6788f03c793c360a22213f608b" title="The main repository endpoint.">_endpoint</a>;

            HttpWebRequest initialWr = null;
            HttpWebRequest realWr = null;
            WebResponse wresp = null;
            XmlDocument xmlDocument = null;

            <span class="keywordflow">if</span> (stripEndpoint)
            {
                target = <span class="keyword">new</span> Uri(this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a64864c6788f03c793c360a22213f608b" title="The main repository endpoint.">_endpoint</a>).GetLeftPart(UriPartial.Authority);
            }
            <span class="keywordtype">string</span> records = target + <a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a69cc508a1fb745ebc36328c65747b936" title="The path for listing records.">LIST_RECORD_PATH</a>;
             
            Debug.WriteLine(<span class="stringliteral">&quot;Requesting records from &quot;</span> + records);
            initialWr = this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a3de286f71c510cf85f1e6e093f1979fb" title="Creates a web request instance to the target URI, adding in basic authorisation from the username and...">GetBasicAuthAtomWebRequest</a>(records);
            initialWr.Method = <span class="stringliteral">&quot;GET&quot;</span>;
            
            <span class="keywordflow">try</span>
            {
                wresp = initialWr.GetResponse();
            }
            <span class="keywordflow">catch</span> (WebException wex)
            {
                <span class="comment">// if we&#39;ve timed out, rethrow the exception</span>
                <span class="keywordflow">if</span> (wex.Status == WebExceptionStatus.Timeout)
                {
                    <span class="keywordflow">throw</span> wex;
                }

                <span class="comment">// being forced to handle exceptions as part of normal program control</span>
                <span class="comment">// is not pleasant (303 in this case)</span>
                Debug.WriteLine(wex.Response.ResponseUri);
                Uri realUri = wex.Response.ResponseUri;
                realWr = this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a3de286f71c510cf85f1e6e093f1979fb" title="Creates a web request instance to the target URI, adding in basic authorisation from the username and...">GetBasicAuthAtomWebRequest</a>(realUri);
                realWr.Method = <span class="stringliteral">&quot;GET&quot;</span>;
                wresp = realWr.GetResponse();
            }            
            
            <span class="keyword">using</span> (Stream resStream = wresp.GetResponseStream())
            {
                <span class="keywordflow">try</span>
                {
                    xmlDocument = <span class="keyword">new</span> XmlDocument();
                    xmlDocument.Load(resStream);
                }
                <span class="keywordflow">catch</span> (XmlException xex)
                {
                    Debug.WriteLine(xex);
                }
            }            

            <span class="keywordflow">if</span> (wresp != null)
            {
                wresp.Close();
            }

            <span class="keywordflow">return</span> xmlDocument;
        }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa86f6388db6702248f5411977fe4bd4e"></a><!-- doxytag: member="uk::ac::soton::ses::SwordClientHandler::PostDocxToContainer" ref="aa86f6388db6702248f5411977fe4bd4e" args="(string docxFilename, string contentType, string containerUri)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string uk.ac.soton.ses.SwordClientHandler.PostDocxToContainer </td>
          <td>(</td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>docxFilename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>contentType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>containerUri</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Posts the supplied docx file to the supplied container. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>docxFilename</em>&nbsp;</td><td>The filename of the docx to post</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>contentType</em>&nbsp;</td><td>The content type of the docx</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>containerUri</em>&nbsp;</td><td>The URI of the container</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd></dd></dl>

<p>Definition at line <a class="el" href="_sword_client_handler_8cs_source.html#l00362">362</a> of file <a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a>.</p>

<p>References <a class="el" href="_sword_atom_reader_8cs_source.html#l00124">uk.ac.soton.ses.SwordAtomReader.EditMediaHref</a>.</p>

<p><div class="fragment"><pre class="fragment">        {
            XmlDocument response = this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#ae858efe4c9e1bf559f8f6003b581686b" title="Gets information about the ePrint at the provided URI.">GetEprintInfo</a>(containerUri);
            <span class="keywordflow">if</span> (response == null) <span class="keywordflow">return</span> null;

            SwordAtomReader sar = <span class="keyword">new</span> SwordAtomReader(response);
            <span class="keywordflow">if</span> (sar == null) <span class="keywordflow">return</span> null;

            <span class="keywordtype">string</span> editMediaHref = sar.EditMediaHref;
            Debug.WriteLine(<span class="stringliteral">&quot;Edit media href is {0}&quot;</span>, editMediaHref);
            <span class="keywordflow">if</span> (String.IsNullOrEmpty(editMediaHref)) <span class="keywordflow">return</span> null;

            <span class="keywordflow">return</span> this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a0232754a219d1c6d958af13777f229aa" title="Deposits the .docx from the supplied filename to the supplied endpoint with the supplied content type...">DepositDocxToContents</a>(docxFilename, contentType, editMediaHref);
        }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a67e043a10d08937039c74ab6994280a9"></a><!-- doxytag: member="uk::ac::soton::ses::SwordClientHandler::PostDocxToContainer" ref="a67e043a10d08937039c74ab6994280a9" args="(string docxFilename)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string uk.ac.soton.ses.SwordClientHandler.PostDocxToContainer </td>
          <td>(</td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>docxFilename</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Deposits the .docx from the supplied filename to the initialised endpoint with the default content type. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>docxFilename</em>&nbsp;</td><td>The filename of the .docx to deposit</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Atom response</dd></dl>

<p>Definition at line <a class="el" href="_sword_client_handler_8cs_source.html#l00276">276</a> of file <a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a>.</p>

<p><div class="fragment"><pre class="fragment">        {
            <span class="keywordflow">return</span> this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a67e043a10d08937039c74ab6994280a9" title="Deposits the .docx from the supplied filename to the initialised endpoint with the default content ty...">PostDocxToContainer</a>(docxFilename, <a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a0385ef24a83c1977fa3c12b57ed3da1c" title=".docx content type">DOCX_CONTENTTYPE</a>);
        }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1c611b95d09b98c3c0bac8c90cb053ea"></a><!-- doxytag: member="uk::ac::soton::ses::SwordClientHandler::PostDocxToContainer" ref="a1c611b95d09b98c3c0bac8c90cb053ea" args="(string docxFilename, string contentType)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string uk.ac.soton.ses.SwordClientHandler.PostDocxToContainer </td>
          <td>(</td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>docxFilename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>contentType</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Deposits the .docx from the supplied filename to the initialised endpoint with the supplied content type. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>docxFilename</em>&nbsp;</td><td>The filename of the .docx to deposit</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>contentType</em>&nbsp;</td><td>The content type to use for the deposition</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Atom response</dd></dl>

<p>Definition at line <a class="el" href="_sword_client_handler_8cs_source.html#l00287">287</a> of file <a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a>.</p>

<p><div class="fragment"><pre class="fragment">        {
            <span class="keywordflow">return</span> this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a67e043a10d08937039c74ab6994280a9" title="Deposits the .docx from the supplied filename to the initialised endpoint with the default content ty...">PostDocxToContainer</a>(docxFilename, contentType, this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a64864c6788f03c793c360a22213f608b" title="The main repository endpoint.">_endpoint</a>);
        }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a983f0345d3573e656bbd53bd385cec79"></a><!-- doxytag: member="uk::ac::soton::ses::SwordClientHandler::PostDocxToRepository" ref="a983f0345d3573e656bbd53bd385cec79" args="(string docxFilename, string contentType, string endpoint)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string uk.ac.soton.ses.SwordClientHandler.PostDocxToRepository </td>
          <td>(</td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>docxFilename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>contentType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>endpoint</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Creates a container on the repository and posts the supplied docx file to that container. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>docxFilename</em>&nbsp;</td><td>The filename of the docx to post</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>contentType</em>&nbsp;</td><td>The content type of the docx</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>endpoint</em>&nbsp;</td><td>The endpoint against which the posting should occur</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd></dd></dl>

<p>Definition at line <a class="el" href="_sword_client_handler_8cs_source.html#l00326">326</a> of file <a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a>.</p>

<p>Referenced by <a class="el" href="_deposit_m_o_repository_control_8cs_source.html#l00143">uk.ac.soton.ses.Word2010DepositMOAddIn.DepositMORepositoryControl._SubmitDocument()</a>, and <a class="el" href="_sword_client_handler_tests_8cs_source.html#l00137">uk.ac.soton.ses.SwordClientHandlerTests.TestPutToDocument()</a>.</p>

<p><div class="fragment"><pre class="fragment">        {
            <span class="keywordtype">string</span> container = this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#ababdd5115fe9213fb1b2dbb71112356a" title="Creates an empty container on the initialised repository.">CreateContainer</a>(endpoint);
            <span class="keywordflow">if</span> (String.IsNullOrEmpty(container))
            {
                <span class="keywordflow">return</span> null;
            }

            <span class="keywordflow">return</span> this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a67e043a10d08937039c74ab6994280a9" title="Deposits the .docx from the supplied filename to the initialised endpoint with the default content ty...">PostDocxToContainer</a>(docxFilename, contentType);
        }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6db06e20d77b596061273903886121a5"></a><!-- doxytag: member="uk::ac::soton::ses::SwordClientHandler::PostDocxToRepository" ref="a6db06e20d77b596061273903886121a5" args="(string docxFilename)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string uk.ac.soton.ses.SwordClientHandler.PostDocxToRepository </td>
          <td>(</td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>docxFilename</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Creates a container on the repository and posts the supplied docx file to that container, using the default docx content type and the initialised endpoint on the instance. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>docxFilename</em>&nbsp;</td><td>The filename of the docx to post</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd></dd></dl>

<p>Definition at line <a class="el" href="_sword_client_handler_8cs_source.html#l00344">344</a> of file <a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a>.</p>

<p><div class="fragment"><pre class="fragment">        {
            <span class="keywordtype">string</span> container = this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#ababdd5115fe9213fb1b2dbb71112356a" title="Creates an empty container on the initialised repository.">CreateContainer</a>(this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a64864c6788f03c793c360a22213f608b" title="The main repository endpoint.">_endpoint</a>);
            <span class="keywordflow">if</span> (String.IsNullOrEmpty(container))
            {
                <span class="keywordflow">return</span> null;
            }

            <span class="keywordflow">return</span> this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a67e043a10d08937039c74ab6994280a9" title="Deposits the .docx from the supplied filename to the initialised endpoint with the default content ty...">PostDocxToContainer</a>(docxFilename, <a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a0385ef24a83c1977fa3c12b57ed3da1c" title=".docx content type">DOCX_CONTENTTYPE</a>, container);
        }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af7267ae1dcd8e060bc81f88f4d1d39b3"></a><!-- doxytag: member="uk::ac::soton::ses::SwordClientHandler::PutToDocument" ref="af7267ae1dcd8e060bc81f88f4d1d39b3" args="(string documentFileName, string endpoint)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool uk.ac.soton.ses.SwordClientHandler.PutToDocument </td>
          <td>(</td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>documentFileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>endpoint</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Performs a PUT to the supplied endpoint with the supplied document filename using </p>
<div class="fragment"><pre class="fragment"><a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a0385ef24a83c1977fa3c12b57ed3da1c" title=".docx content type">DOCX_CONTENTTYPE</a>
</pre></div><p>. </p>
<p>This will update an existing entry on the SWORD target</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>documentFileName</em>&nbsp;</td><td>The filename of the document to use for the update</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>endpoint</em>&nbsp;</td><td>The endpoint against which the update should occur</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Atom response</dd></dl>

<p>Definition at line <a class="el" href="_sword_client_handler_8cs_source.html#l00448">448</a> of file <a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a>.</p>

<p>Referenced by <a class="el" href="_deposit_m_o_repository_control_8cs_source.html#l00143">uk.ac.soton.ses.Word2010DepositMOAddIn.DepositMORepositoryControl._SubmitDocument()</a>, <a class="el" href="_sword_client_handler_tests_8cs_source.html#l00131">uk.ac.soton.ses.SwordClientHandlerTests.TestPutOnly()</a>, and <a class="el" href="_sword_client_handler_tests_8cs_source.html#l00137">uk.ac.soton.ses.SwordClientHandlerTests.TestPutToDocument()</a>.</p>

<p><div class="fragment"><pre class="fragment">        {
            <span class="keywordflow">return</span> this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#af7267ae1dcd8e060bc81f88f4d1d39b3" title="Performs a PUT to the supplied endpoint with the supplied document filename using DOCX_CONTENTTYPE...">PutToDocument</a>(documentFileName, endpoint, <a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a0385ef24a83c1977fa3c12b57ed3da1c" title=".docx content type">DOCX_CONTENTTYPE</a>);
        }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a69aff38a93d33cb3b2568c840343b58a"></a><!-- doxytag: member="uk::ac::soton::ses::SwordClientHandler::PutToDocument" ref="a69aff38a93d33cb3b2568c840343b58a" args="(string documentFileName, string endpoint, string contentType)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool uk.ac.soton.ses.SwordClientHandler.PutToDocument </td>
          <td>(</td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>documentFileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>endpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>contentType</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Performs a PUT to the supplied endpoint with the supplied document filename using the supplied content type. </p>
<p>This will update an existing entry on the SWORD target</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>documentFileName</em>&nbsp;</td><td>The filename of the document to use for the update</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>endpoint</em>&nbsp;</td><td>The endpoint against which the update should occur</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>contentType</em>&nbsp;</td><td>The content type to use for the update</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Atom response</dd></dl>

<p>Definition at line <a class="el" href="_sword_client_handler_8cs_source.html#l00461">461</a> of file <a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a>.</p>

<p><div class="fragment"><pre class="fragment">        {                     
            HttpWebRequest wr = this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a3de286f71c510cf85f1e6e093f1979fb" title="Creates a web request instance to the target URI, adding in basic authorisation from the username and...">GetBasicAuthAtomWebRequest</a>(endpoint);
            FileInfo fi = <span class="keyword">new</span> FileInfo(documentFileName);
            wr.Method = <span class="stringliteral">&quot;PUT&quot;</span>;
            wr.Headers.Add(<span class="stringliteral">&quot;Content-Disposition&quot;</span>, <span class="stringliteral">&quot;form-data; name=\&quot;&quot;</span> + fi.Name + <span class="stringliteral">&quot;\&quot;; filename=\&quot;&quot;</span> + fi.Name + <span class="stringliteral">&quot;\&quot;&quot;</span>);            
            wr.ContentType = contentType;
            wr.ContentLength = fi.Length;
            wr.Headers.Add(<span class="stringliteral">&quot;X-Extract-Media&quot;</span>, <span class="stringliteral">&quot;true&quot;</span>);
            wr.Headers.Add(<span class="stringliteral">&quot;X-Override-Metadata&quot;</span>, <span class="stringliteral">&quot;true&quot;</span>);
            <span class="comment">//wr.Headers.Add(&quot;Metadata-Relevant&quot;, &quot;true&quot;);</span>
            wr.Headers.Add(<span class="stringliteral">&quot;In-Progress&quot;</span>, <span class="stringliteral">&quot;true&quot;</span>);
            this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a5de096e263959293cbeae7b18a28fc1c" title="Writes the file in filename to the web request wr.">WriteFileToRequest</a>(documentFileName, wr);
            HttpWebResponse response = null;
            <span class="keywordflow">try</span>

            {
                response = (HttpWebResponse)wr.GetResponse();
            }
            <span class="keywordflow">catch</span> (WebException ex)
            {
                Debug.WriteLine(ex);
                <span class="keywordflow">if</span> (ex.Response != null &amp;&amp; ex.Response.Headers != null)
                {
                    <span class="keywordflow">foreach</span> (HttpResponseHeader h <span class="keywordflow">in</span> ex.Response.Headers)
                    {
                        Debug.WriteLine(<span class="stringliteral">&quot;Header: &quot;</span> + h.ToString());
                    }
                }
            }

            <span class="keywordflow">if</span> (response == null) { <span class="keywordflow">return</span> <span class="keyword">false</span>; } 

            <span class="keywordtype">bool</span> responseOk = <span class="keyword">false</span>;
            <span class="keywordflow">if</span> (response.StatusCode == HttpStatusCode.OK)
            {
                responseOk = <span class="keyword">true</span>;
            }            

            <span class="keywordflow">if</span> (response != null)
            {
                response.Close();
            }
            <span class="keywordflow">return</span> responseOk;            
        }     
</pre></div></p>

</div>
</div>
<a class="anchor" id="af74880abd60b9ca07bdbeb69207a6052"></a><!-- doxytag: member="uk::ac::soton::ses::SwordClientHandler::ResolveInbox" ref="af74880abd60b9ca07bdbeb69207a6052" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">internal void uk.ac.soton.ses.SwordClientHandler.ResolveInbox </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Resolves the inbox based on the currently-supplied endpoint. </p>

<p>Definition at line <a class="el" href="_sword_client_handler_8cs_source.html#l00150">150</a> of file <a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a>.</p>

<p>Referenced by <a class="el" href="_sword_client_handler_tests_8cs_source.html#l00173">uk.ac.soton.ses.SwordClientHandlerTests.TestResolveInbox()</a>.</p>

<p><div class="fragment"><pre class="fragment">        {
            <span class="comment">// if we&#39;re not supposed to resolve the inbox, skip this step</span>
            <span class="keywordflow">if</span> (!this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a9e50e2fb359bcae16dbd2e39dccfe493" title="TODO: Whether the inbox URL should be resolved from the HTML of the supplied endpoint.">_resolveInbox</a>)
            {
                <span class="keywordflow">return</span>;
            }

            <span class="keywordtype">string</span> inbox = HtmlScraper.GetAttributeContent(this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a64864c6788f03c793c360a22213f608b" title="The main repository endpoint.">_endpoint</a>, <span class="stringliteral">&quot;link&quot;</span>, <span class="stringliteral">&quot;rel&quot;</span>, <span class="stringliteral">&quot;SwordDeposit&quot;</span>, <span class="stringliteral">&quot;href&quot;</span>);

            <span class="keywordflow">if</span> (!String.IsNullOrEmpty(inbox))
            {
                this.<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a64864c6788f03c793c360a22213f608b" title="The main repository endpoint.">_endpoint</a> = inbox;
            }
        }        
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5de096e263959293cbeae7b18a28fc1c"></a><!-- doxytag: member="uk::ac::soton::ses::SwordClientHandler::WriteFileToRequest" ref="a5de096e263959293cbeae7b18a28fc1c" args="(string filename, HttpWebRequest wr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void uk.ac.soton.ses.SwordClientHandler.WriteFileToRequest </td>
          <td>(</td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">HttpWebRequest&nbsp;</td>
          <td class="paramname"> <em>wr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Writes the file in </p>
<div class="fragment"><pre class="fragment">filename
</pre></div><p> to the web request </p>
<div class="fragment"><pre class="fragment">wr
</pre></div><p>. </p>
<p>This uses a buffer whose size is stored statically in </p>
<div class="fragment"><pre class="fragment"><a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a478b92910f3fa8781498c163599f5b26" title="Buffer size for uploads in bytes.">BUFFER_SIZE</a>
</pre></div><p> to speed up the transfer</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>filename</em>&nbsp;</td><td>The absolute filename to send</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>wr</em>&nbsp;</td><td>The web request on which to send the file</td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_sword_client_handler_8cs_source.html#l00204">204</a> of file <a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a>.</p>

<p><div class="fragment"><pre class="fragment">        {
            wr.Timeout = 15000;

            <span class="keyword">using</span> (Stream requestStream = wr.GetRequestStream())
            {
                <span class="keyword">using</span> (FileStream fs = File.OpenRead(filename))
                {
                    <span class="keywordtype">int</span> readCount;
                    byte[] buffer = <span class="keyword">new</span> byte[<a class="code" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a478b92910f3fa8781498c163599f5b26" title="Buffer size for uploads in bytes.">BUFFER_SIZE</a>];
                    <span class="keywordflow">while</span> ((readCount = fs.Read(buffer, 0, buffer.Length)) != 0)
                    {
                        Debug.WriteLine(String.Format(<span class="stringliteral">&quot;Doing a block, at {0}&quot;</span>, fs.Position));
                        requestStream.Write(buffer, 0, readCount);                        
                    }
                    Debug.WriteLine(<span class="stringliteral">&quot;Finished with input file&quot;</span>);
                }
                Debug.WriteLine(<span class="stringliteral">&quot;Finished with output stream&quot;</span>);
            }
        }
</pre></div></p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a64864c6788f03c793c360a22213f608b"></a><!-- doxytag: member="uk::ac::soton::ses::SwordClientHandler::_endpoint" ref="a64864c6788f03c793c360a22213f608b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string <a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a64864c6788f03c793c360a22213f608b">uk.ac.soton.ses.SwordClientHandler._endpoint</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The main repository endpoint. </p>

<p>Definition at line <a class="el" href="_sword_client_handler_8cs_source.html#l00083">83</a> of file <a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a>.</p>

</div>
</div>
<a class="anchor" id="a9bb60533f7724e9de9e0a3250b8a6766"></a><!-- doxytag: member="uk::ac::soton::ses::SwordClientHandler::_password" ref="a9bb60533f7724e9de9e0a3250b8a6766" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string <a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a9bb60533f7724e9de9e0a3250b8a6766">uk.ac.soton.ses.SwordClientHandler._password</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The repository password. </p>

<p>Definition at line <a class="el" href="_sword_client_handler_8cs_source.html#l00078">78</a> of file <a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a>.</p>

</div>
</div>
<a class="anchor" id="a9e50e2fb359bcae16dbd2e39dccfe493"></a><!-- doxytag: member="uk::ac::soton::ses::SwordClientHandler::_resolveInbox" ref="a9e50e2fb359bcae16dbd2e39dccfe493" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">internal bool <a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a9e50e2fb359bcae16dbd2e39dccfe493">uk.ac.soton.ses.SwordClientHandler._resolveInbox</a> = false<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>TODO: Whether the inbox URL should be resolved from the HTML of the supplied endpoint. </p>
<p>TODO </p>

<p>Definition at line <a class="el" href="_sword_client_handler_8cs_source.html#l00068">68</a> of file <a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a>.</p>

<p>Referenced by <a class="el" href="_sword_client_handler_tests_8cs_source.html#l00173">uk.ac.soton.ses.SwordClientHandlerTests.TestResolveInbox()</a>.</p>

</div>
</div>
<a class="anchor" id="a5dc115a3a462fa648848dc202bcc6825"></a><!-- doxytag: member="uk::ac::soton::ses::SwordClientHandler::_username" ref="a5dc115a3a462fa648848dc202bcc6825" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string <a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a5dc115a3a462fa648848dc202bcc6825">uk.ac.soton.ses.SwordClientHandler._username</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The repository username. </p>

<p>Definition at line <a class="el" href="_sword_client_handler_8cs_source.html#l00073">73</a> of file <a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a>.</p>

</div>
</div>
<a class="anchor" id="a478b92910f3fa8781498c163599f5b26"></a><!-- doxytag: member="uk::ac::soton::ses::SwordClientHandler::BUFFER_SIZE" ref="a478b92910f3fa8781498c163599f5b26" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a478b92910f3fa8781498c163599f5b26">uk.ac.soton.ses.SwordClientHandler.BUFFER_SIZE</a> = 16 * 1024<code> [static, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Buffer size for uploads in bytes. </p>

<p>Definition at line <a class="el" href="_sword_client_handler_8cs_source.html#l00040">40</a> of file <a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a>.</p>

</div>
</div>
<a class="anchor" id="a0385ef24a83c1977fa3c12b57ed3da1c"></a><!-- doxytag: member="uk::ac::soton::ses::SwordClientHandler::DOCX_CONTENTTYPE" ref="a0385ef24a83c1977fa3c12b57ed3da1c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string <a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a0385ef24a83c1977fa3c12b57ed3da1c">uk.ac.soton.ses.SwordClientHandler.DOCX_CONTENTTYPE</a> = &quot;application/vnd.openxmlformats-officedocument.wordprocessingml.document&quot;<code> [static, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>.docx content type </p>

<p>Definition at line <a class="el" href="_sword_client_handler_8cs_source.html#l00050">50</a> of file <a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a>.</p>

</div>
</div>
<a class="anchor" id="ae5151720040713916b0eb8c2b640de63"></a><!-- doxytag: member="uk::ac::soton::ses::SwordClientHandler::EP2_PACKAGING" ref="ae5151720040713916b0eb8c2b640de63" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string <a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#ae5151720040713916b0eb8c2b640de63">uk.ac.soton.ses.SwordClientHandler.EP2_PACKAGING</a> = &quot;http://eprints.org/ep2/data/2.0&quot;<code> [static, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>EP2 packaging header value. </p>

<p>Definition at line <a class="el" href="_sword_client_handler_8cs_source.html#l00045">45</a> of file <a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a>.</p>

</div>
</div>
<a class="anchor" id="a73b47f940f995590abe3530d99972375"></a><!-- doxytag: member="uk::ac::soton::ses::SwordClientHandler::EXTRACT_MEDIA" ref="a73b47f940f995590abe3530d99972375" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string <a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a73b47f940f995590abe3530d99972375">uk.ac.soton.ses.SwordClientHandler.EXTRACT_MEDIA</a> = &quot;true&quot;<code> [static, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Should media be extracted by default, or ignored? Note that this is going into a header so it should be a string rather than a Boolean. </p>

<p>Definition at line <a class="el" href="_sword_client_handler_8cs_source.html#l00062">62</a> of file <a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a>.</p>

</div>
</div>
<a class="anchor" id="a69cc508a1fb745ebc36328c65747b936"></a><!-- doxytag: member="uk::ac::soton::ses::SwordClientHandler::LIST_RECORD_PATH" ref="a69cc508a1fb745ebc36328c65747b936" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string <a class="el" href="classuk_1_1ac_1_1soton_1_1ses_1_1_sword_client_handler.html#a69cc508a1fb745ebc36328c65747b936">uk.ac.soton.ses.SwordClientHandler.LIST_RECORD_PATH</a> = &quot;/id/records&quot;<code> [static, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The path for listing records. </p>

<p>Definition at line <a class="el" href="_sword_client_handler_8cs_source.html#l00055">55</a> of file <a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a>.</p>

</div>
</div>
<hr/><h2>Property Documentation</h2>
<a class="anchor" id="ace1337ce98ce3433b17bee6484e2a037"></a><!-- doxytag: member="uk::ac::soton::ses::SwordClientHandler::Endpoint" ref="ace1337ce98ce3433b17bee6484e2a037" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string uk.ac.soton.ses.SwordClientHandler.Endpoint<code> [set]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Sets the endpoint associated with the repository. </p>

<p>Definition at line <a class="el" href="_sword_client_handler_8cs_source.html#l00111">111</a> of file <a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a>.</p>

</div>
</div>
<a class="anchor" id="ade1862c2c508cc4a1c5007ee01e9ccc5"></a><!-- doxytag: member="uk::ac::soton::ses::SwordClientHandler::Password" ref="ade1862c2c508cc4a1c5007ee01e9ccc5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string uk.ac.soton.ses.SwordClientHandler.Password<code> [set]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Sets the password associated with the repository. </p>

<p>Definition at line <a class="el" href="_sword_client_handler_8cs_source.html#l00100">100</a> of file <a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a>.</p>

</div>
</div>
<a class="anchor" id="a33c1db88d01e26235f6ffbf9888696f9"></a><!-- doxytag: member="uk::ac::soton::ses::SwordClientHandler::Username" ref="a33c1db88d01e26235f6ffbf9888696f9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string uk.ac.soton.ses.SwordClientHandler.Username<code> [set]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Sets the username associated with the repository. </p>

<p>Definition at line <a class="el" href="_sword_client_handler_8cs_source.html#l00089">89</a> of file <a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>Q:/Projects/SwordHandler/SwordHandler/<a class="el" href="_sword_client_handler_8cs_source.html">SwordClientHandler.cs</a></li>
</ul>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Properties</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Tue Nov 29 2011 16:57:43 for Word 2010 DepositMO plugin - API reference and source guide by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
