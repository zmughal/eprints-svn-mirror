#!/usr/bin/perl -w

######################################################################
#
#  EPrint Static Abstract Page Generator
#
#   Causes the system to (re)generate static abstract pages for all
#   of the eprints in the system.
#
######################################################################
#
#  __COPYRIGHT__
#
# Copyright 2000-2008 University of Southampton. All Rights Reserved.
# 
#  __LICENSE__
#
######################################################################

use EPrints::EPrint;
use EPrints::Session;
use EPrints::HTMLRender;
use EPrints::Subject;
use EPrints::Log;

use strict;


my $session = new EPrints::Session( 1 , $ARGV[0] );

my $dataset = $session->getSite->getDataSet( "archive" ),

print "start\n";
my @eprints = $session->{database}->get_all( $dataset );
print "gotall\n";

my $eprint;
foreach $eprint (@eprints)
{
	print "-----ON--------\n";
	print EPrints::Log::render_struct( $eprint );
	print "-----OFF--------\n";
#	EPrints::Log::debug( "generate_abstracts",
#	                     "Generating abstract for $eprint->{eprintid}" );
print $eprint->getValue( "eprintid" )."\n";
	$eprint->generate_static();
}
print "done\n";
