<?xml version="1.0" encoding="utf-8"?>

<!--

Action buttons (Previous/Save/Next) can be shown "top", "bottom" or "both":
<stage name="type" action_buttons="both">
  <component><field ref="type" required="yes" /></component>
</stage>

-->

<workflow xmlns="http://eprints.org/ep3/workflow" xmlns:epc="http://eprints.org/ep3/control">
  <flow>
  	<epc:choose>
		<epc:when test="$method='Register::OpenID'">
			<stage ref="openid"/>
		</epc:when>
		<epc:otherwise>
			<stage ref="internal"/>
		</epc:otherwise>
	</epc:choose>
  </flow>

  <stage name="openid">
    <component show_help="always"><field ref="name" /></component>
    <component show_help="always"><field ref="newemail" required="yes" /></component>
    <component show_help="always"><field ref="openid_identifier" required="yes" /></component>
  </stage>

  <stage name="internal">
    <component show_help="always"><field ref="name" /></component>
    <component show_help="always"><field ref="newemail" required="yes" /></component>
    <component show_help="always"><field ref="username" required="yes" /></component>
    <component show_help="always"><field ref="newpassword" required="yes" /></component>
  </stage>

</workflow>
